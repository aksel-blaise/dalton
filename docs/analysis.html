<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Analysis | Supplementary materials for paper: Article title here</title>
  <meta name="description" content="Morphological analysis of Dalton projectile points" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Analysis | Supplementary materials for paper: Article title here" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Morphological analysis of Dalton projectile points" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Analysis | Supplementary materials for paper: Article title here" />
  
  <meta name="twitter:description" content="Morphological analysis of Dalton projectile points" />
  

<meta name="author" content="Robert Z. Selden, Jr." />


<meta name="date" content="2020-08-29" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="landmark-sampling-evaluation-curve.html"/>
<link rel="next" href="open.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<script async defer src="https://hypothes.is/embed.js"></script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-117287158-2', 'auto');
  ga('send', 'pageview');

</script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Dalton Morphology</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#acknowledgments"><i class="fa fa-check"></i><b>0.1</b> Acknowledgments</a></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#funding"><i class="fa fa-check"></i><b>0.2</b> Funding</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="landmarking-protocol.html"><a href="landmarking-protocol.html"><i class="fa fa-check"></i><b>1</b> Landmarking Protocol</a><ul>
<li class="chapter" data-level="1.1" data-path="landmarking-protocol.html"><a href="landmarking-protocol.html#generating-the-spline"><i class="fa fa-check"></i><b>1.1</b> Generating the spline</a></li>
<li class="chapter" data-level="1.2" data-path="landmarking-protocol.html"><a href="landmarking-protocol.html#splitting-the-spline"><i class="fa fa-check"></i><b>1.2</b> Splitting the spline</a></li>
<li class="chapter" data-level="1.3" data-path="landmarking-protocol.html"><a href="landmarking-protocol.html#spline-split-at-location-of-lm1"><i class="fa fa-check"></i><b>1.3</b> Spline split at location of LM1</a></li>
<li class="chapter" data-level="1.4" data-path="landmarking-protocol.html"><a href="landmarking-protocol.html#spline-split-at-locations-of-lm2---lm3"><i class="fa fa-check"></i><b>1.4</b> Spline split at locations of LM2 - LM3</a></li>
<li class="chapter" data-level="1.5" data-path="landmarking-protocol.html"><a href="landmarking-protocol.html#spline-split-at-locations-of-lm4---lm5"><i class="fa fa-check"></i><b>1.5</b> Spline split at locations of LM4 - LM5</a></li>
<li class="chapter" data-level="1.6" data-path="landmarking-protocol.html"><a href="landmarking-protocol.html#spline-split-at-location-of-lm6"><i class="fa fa-check"></i><b>1.6</b> Spline split at location of LM6</a></li>
<li class="chapter" data-level="1.7" data-path="landmarking-protocol.html"><a href="landmarking-protocol.html#final-spline"><i class="fa fa-check"></i><b>1.7</b> Final spline</a></li>
<li class="chapter" data-level="1.8" data-path="landmarking-protocol.html"><a href="landmarking-protocol.html#landmark-and-semilandmark-placement"><i class="fa fa-check"></i><b>1.8</b> Landmark and semilandmark placement</a></li>
<li class="chapter" data-level="1.9" data-path="index.html"><a href="index.html#acknowledgments"><i class="fa fa-check"></i><b>1.9</b> Acknowledgments</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="landmark-sampling-evaluation-curve.html"><a href="landmark-sampling-evaluation-curve.html"><i class="fa fa-check"></i><b>2</b> Landmark Sampling Evaluation Curve</a><ul>
<li class="chapter" data-level="2.1" data-path="landmark-sampling-evaluation-curve.html"><a href="landmark-sampling-evaluation-curve.html#initial-configuration"><i class="fa fa-check"></i><b>2.1</b> Initial configuration</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="analysis.html"><a href="analysis.html"><i class="fa fa-check"></i><b>3</b> Analysis</a><ul>
<li class="chapter" data-level="3.1" data-path="analysis.html"><a href="analysis.html#generalised-procrustes-analysis"><i class="fa fa-check"></i><b>3.1</b> Generalised Procrustes Analysis</a></li>
<li class="chapter" data-level="3.2" data-path="analysis.html"><a href="analysis.html#principal-components-analysis"><i class="fa fa-check"></i><b>3.2</b> Principal Components Analysis</a></li>
<li class="chapter" data-level="3.3" data-path="analysis.html"><a href="analysis.html#define-models"><i class="fa fa-check"></i><b>3.3</b> Define models</a></li>
<li class="chapter" data-level="3.4" data-path="analysis.html"><a href="analysis.html#allometry"><i class="fa fa-check"></i><b>3.4</b> Allometry</a></li>
<li class="chapter" data-level="3.5" data-path="analysis.html"><a href="analysis.html#sizeshape-group"><i class="fa fa-check"></i><b>3.5</b> Size/Shape ~ Group?</a></li>
<li class="chapter" data-level="3.6" data-path="analysis.html"><a href="analysis.html#morphological-disparity"><i class="fa fa-check"></i><b>3.6</b> Morphological disparity</a></li>
<li class="chapter" data-level="3.7" data-path="analysis.html"><a href="analysis.html#mean-shapes"><i class="fa fa-check"></i><b>3.7</b> Mean shapes</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="open.html"><a href="open.html"><i class="fa fa-check"></i><b>4</b> Open Review</a><ul>
<li class="chapter" data-level="4.1" data-path="open.html"><a href="open.html#faq-about-open-review"><i class="fa fa-check"></i><b>4.1</b> FAQ about open review</a><ul>
<li class="chapter" data-level="4.1.1" data-path="open.html"><a href="open.html#what-kind-of-feedback-are-you-looking-for"><i class="fa fa-check"></i><b>4.1.1</b> What kind of feedback are you looking for?</a></li>
<li class="chapter" data-level="4.1.2" data-path="open.html"><a href="open.html#can-i-see-the-annotations-that-others-are-making"><i class="fa fa-check"></i><b>4.1.2</b> Can I see the annotations that others are making?</a></li>
<li class="chapter" data-level="4.1.3" data-path="open.html"><a href="open.html#what-are-the-benefits-for-readers"><i class="fa fa-check"></i><b>4.1.3</b> What are the benefits for readers?</a></li>
<li class="chapter" data-level="4.1.4" data-path="open.html"><a href="open.html#what-are-the-benefits-for-authors-and-publishers"><i class="fa fa-check"></i><b>4.1.4</b> What are the benefits for authors and publishers?</a></li>
<li class="chapter" data-level="4.1.5" data-path="open.html"><a href="open.html#has-anyone-ever-done-something-like-this-before"><i class="fa fa-check"></i><b>4.1.5</b> Has anyone ever done something like this before?</a></li>
<li class="chapter" data-level="4.1.6" data-path="open.html"><a href="open.html#what-kind-of-information-are-you-collecting-and-how-will-that-information-be-used"><i class="fa fa-check"></i><b>4.1.6</b> What kind of information are you collecting and how will that information be used?</a></li>
<li class="chapter" data-level="4.1.7" data-path="open.html"><a href="open.html#how-i-can-learn-more-about-traditional-peer-review-of-academic-books"><i class="fa fa-check"></i><b>4.1.7</b> How I can learn more about traditional peer review of academic books?</a></li>
<li class="chapter" data-level="4.1.8" data-path="open.html"><a href="open.html#can-i-do-this-with-my-book"><i class="fa fa-check"></i><b>4.1.8</b> Can I do this with my book?</a></li>
<li class="chapter" data-level="4.1.9" data-path="open.html"><a href="open.html#i-have-a-different-question-about-open-review.-how-can-i-get-in-touch"><i class="fa fa-check"></i><b>4.1.9</b> I have a different question about Open Review. How can I get in touch?</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="open.html"><a href="open.html#privacy-and-consent-policy"><i class="fa fa-check"></i><b>4.2</b> Privacy and Consent Policy</a><ul>
<li class="chapter" data-level="4.2.1" data-path="open.html"><a href="open.html#overview"><i class="fa fa-check"></i><b>4.2.1</b> Overview</a></li>
<li class="chapter" data-level="4.2.2" data-path="open.html"><a href="open.html#what-information-do-we-collect"><i class="fa fa-check"></i><b>4.2.2</b> What information do we collect?</a></li>
<li class="chapter" data-level="4.2.3" data-path="open.html"><a href="open.html#how-do-we-use-your-information"><i class="fa fa-check"></i><b>4.2.3</b> How do we use your information?</a></li>
<li class="chapter" data-level="4.2.4" data-path="open.html"><a href="open.html#how-do-we-protect-your-information"><i class="fa fa-check"></i><b>4.2.4</b> How do we protect your information?</a></li>
<li class="chapter" data-level="4.2.5" data-path="open.html"><a href="open.html#do-we-use-cookies"><i class="fa fa-check"></i><b>4.2.5</b> Do we use cookies?</a></li>
<li class="chapter" data-level="4.2.6" data-path="open.html"><a href="open.html#your-consent"><i class="fa fa-check"></i><b>4.2.6</b> Your consent</a></li>
<li class="chapter" data-level="4.2.7" data-path="open.html"><a href="open.html#questions"><i class="fa fa-check"></i><b>4.2.7</b> Questions</a></li>
<li class="chapter" data-level="4.2.8" data-path="open.html"><a href="open.html#changes-to-our-privacy-and-consent-policy"><i class="fa fa-check"></i><b>4.2.8</b> Changes to our Privacy and Consent Policy</a></li>
<li class="chapter" data-level="4.2.9" data-path="index.html"><a href="index.html#acknowledgments"><i class="fa fa-check"></i><b>4.2.9</b> Acknowledgments</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Supplementary materials for paper: Article title here</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">

<div class = rmdreview>
This volume is in <b><a href="open.html#open">Open Review</a></b>. I want your feedback to make the volume better for you and other readers. To add your annotation, <span style="background-color: #3297FD; color: white">select some text</span> and then click the <i class="h-icon-annotate"></i> on the pop-up menu. To see the annotations of others, click the <i class="h-icon-chevron-left"></i> in the upper right hand corner of the page <i class="fa fa-arrow-circle-right  fa-rotate-315" aria-hidden="true"></i>
</div>
<div id="analysis" class="section level1">
<h1><span class="header-section-number">Chapter 3</span> Analysis</h1>
<div id="generalised-procrustes-analysis" class="section level2">
<h2><span class="header-section-number">3.1</span> Generalised Procrustes Analysis</h2>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="analysis.html#cb21-1"></a><span class="co"># library(devtools)</span></span>
<span id="cb21-2"><a href="analysis.html#cb21-2"></a><span class="co"># devtools::install_github(&quot;geomorphR/geomorph&quot;, ref = &quot;Stable&quot;, build_vignettes = TRUE)</span></span>
<span id="cb21-3"><a href="analysis.html#cb21-3"></a><span class="kw">library</span>(geomorph)</span>
<span id="cb21-4"><a href="analysis.html#cb21-4"></a><span class="kw">library</span>(wesanderson)</span>
<span id="cb21-5"><a href="analysis.html#cb21-5"></a><span class="kw">setwd</span>(<span class="kw">getwd</span>())</span>
<span id="cb21-6"><a href="analysis.html#cb21-6"></a></span>
<span id="cb21-7"><a href="analysis.html#cb21-7"></a><span class="co"># read GM data</span></span>
<span id="cb21-8"><a href="analysis.html#cb21-8"></a><span class="kw">source</span>(<span class="st">&#39;readmulti.csv.R&#39;</span>)</span>
<span id="cb21-9"><a href="analysis.html#cb21-9"></a></span>
<span id="cb21-10"><a href="analysis.html#cb21-10"></a><span class="co"># read .csv files</span></span>
<span id="cb21-11"><a href="analysis.html#cb21-11"></a><span class="kw">setwd</span>(<span class="st">&quot;./data&quot;</span>)</span>
<span id="cb21-12"><a href="analysis.html#cb21-12"></a>filelist &lt;-<span class="st"> </span><span class="kw">list.files</span>(<span class="dt">pattern =</span> <span class="st">&quot;.csv&quot;</span>)</span>
<span id="cb21-13"><a href="analysis.html#cb21-13"></a>coords &lt;-<span class="st"> </span><span class="kw">readmulti.csv</span>(filelist)</span>
<span id="cb21-14"><a href="analysis.html#cb21-14"></a><span class="kw">setwd</span>(<span class="st">&quot;../&quot;</span>)</span>
<span id="cb21-15"><a href="analysis.html#cb21-15"></a></span>
<span id="cb21-16"><a href="analysis.html#cb21-16"></a><span class="co"># read qualitative data</span></span>
<span id="cb21-17"><a href="analysis.html#cb21-17"></a>qdata &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;qdata.csv&quot;</span>,<span class="dt">header=</span><span class="ot">TRUE</span>,<span class="dt">row.names=</span><span class="dv">1</span>)</span>
<span id="cb21-18"><a href="analysis.html#cb21-18"></a>qdata &lt;-<span class="st"> </span>qdata[<span class="kw">match</span>(<span class="kw">dimnames</span>(coords)[[<span class="dv">3</span>]],<span class="kw">rownames</span>(qdata)),]</span>
<span id="cb21-19"><a href="analysis.html#cb21-19"></a>qdata</span></code></pre></div>
<pre><code>##               heart.out heart.reg
## 11AI225               H         H
## 11HE445               N         P
## HK49_1462             N         I
## HK49_2                N         I
## HK49_4                N         I
## HK49_7                N         I
## KeilMangold13         H         H
## KeilMangold3          H         H
## KeilMangold8          H         H
## Kinzer46              N         P
## Kinzer49              N         P
## Kinzer50              N         P</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="analysis.html#cb23-1"></a><span class="co"># gpa</span></span>
<span id="cb23-2"><a href="analysis.html#cb23-2"></a>Y.gpa &lt;-<span class="st"> </span><span class="kw">gpagen</span>(coords, <span class="dt">PrinAxes =</span> <span class="ot">TRUE</span>, <span class="dt">ProcD =</span> <span class="ot">TRUE</span>, <span class="dt">Proj =</span> <span class="ot">TRUE</span>, <span class="dt">print.progress =</span> <span class="ot">FALSE</span>)</span>
<span id="cb23-3"><a href="analysis.html#cb23-3"></a><span class="co"># plot consensus configuration</span></span>
<span id="cb23-4"><a href="analysis.html#cb23-4"></a><span class="kw">plot</span>(Y.gpa<span class="op">$</span>consensus[,<span class="kw">c</span>(<span class="st">&quot;X&quot;</span>, <span class="st">&quot;Y&quot;</span>)], <span class="dt">asp =</span> <span class="dv">1</span>, <span class="dt">pch =</span> <span class="dv">20</span>)</span></code></pre></div>
<p><img src="dalton_files/figure-html/gpa-1.png" width="100%" /></p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="analysis.html#cb24-1"></a><span class="co"># gpa plot</span></span>
<span id="cb24-2"><a href="analysis.html#cb24-2"></a><span class="co"># knitr::include_graphics(&#39;images/gpa3d.png&#39;)</span></span>
<span id="cb24-3"><a href="analysis.html#cb24-3"></a><span class="co"># fig.cap=&quot;Results of generalized Procrustes analysis.&quot;</span></span>
<span id="cb24-4"><a href="analysis.html#cb24-4"></a></span>
<span id="cb24-5"><a href="analysis.html#cb24-5"></a><span class="co"># geomorph data frame</span></span>
<span id="cb24-6"><a href="analysis.html#cb24-6"></a>gdf &lt;-<span class="st"> </span><span class="kw">geomorph.data.frame</span>(<span class="dt">shape =</span> Y.gpa<span class="op">$</span>coords, <span class="dt">size =</span> Y.gpa<span class="op">$</span>Csize, <span class="dt">heart =</span> qdata<span class="op">$</span>heart.out, <span class="dt">hreg =</span> qdata<span class="op">$</span>heart.reg)</span>
<span id="cb24-7"><a href="analysis.html#cb24-7"></a></span>
<span id="cb24-8"><a href="analysis.html#cb24-8"></a><span class="co"># attributes for boxplots</span></span>
<span id="cb24-9"><a href="analysis.html#cb24-9"></a>csz &lt;-<span class="st"> </span>Y.gpa<span class="op">$</span>Csize <span class="co"># centroid size</span></span>
<span id="cb24-10"><a href="analysis.html#cb24-10"></a>heart &lt;-<span class="st"> </span>qdata<span class="op">$</span>heart.out <span class="co"># heartland in/out</span></span>
<span id="cb24-11"><a href="analysis.html#cb24-11"></a>hreg &lt;-<span class="st"> </span>qdata<span class="op">$</span>heart.reg <span class="co"># heartland region</span></span>
<span id="cb24-12"><a href="analysis.html#cb24-12"></a></span>
<span id="cb24-13"><a href="analysis.html#cb24-13"></a><span class="co"># boxplot of Dalton point centroid size by in/out heartland</span></span>
<span id="cb24-14"><a href="analysis.html#cb24-14"></a><span class="kw">boxplot</span>(csz<span class="op">~</span>heart,</span>
<span id="cb24-15"><a href="analysis.html#cb24-15"></a>        <span class="dt">names =</span> <span class="kw">c</span>(<span class="st">&quot;H&quot;</span>,<span class="st">&quot;N&quot;</span>), <span class="co"># heartland (H), and not heartland (N)</span></span>
<span id="cb24-16"><a href="analysis.html#cb24-16"></a>        <span class="dt">xlab =</span> <span class="st">&quot;Heartland&quot;</span>,</span>
<span id="cb24-17"><a href="analysis.html#cb24-17"></a>        <span class="dt">ylab =</span> <span class="st">&quot;Centroid Size&quot;</span>,</span>
<span id="cb24-18"><a href="analysis.html#cb24-18"></a>        <span class="dt">col =</span> <span class="kw">wes_palette</span>(<span class="st">&quot;Moonrise2&quot;</span>),</span>
<span id="cb24-19"><a href="analysis.html#cb24-19"></a>        )</span></code></pre></div>
<p><img src="dalton_files/figure-html/gpa-2.png" width="100%" /></p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="analysis.html#cb25-1"></a>fig.cap =<span class="st"> &quot;Boxplot of centroid size by Heartland (in/out).&quot;</span></span>
<span id="cb25-2"><a href="analysis.html#cb25-2"></a></span>
<span id="cb25-3"><a href="analysis.html#cb25-3"></a><span class="co"># boxplot of Dalton point centroid size by heartland + regions</span></span>
<span id="cb25-4"><a href="analysis.html#cb25-4"></a><span class="kw">boxplot</span>(csz<span class="op">~</span>hreg,</span>
<span id="cb25-5"><a href="analysis.html#cb25-5"></a>        <span class="dt">names =</span> <span class="kw">c</span>(<span class="st">&quot;H&quot;</span>,<span class="st">&quot;I&quot;</span>,<span class="st">&quot;P&quot;</span>), <span class="co"># heartland (H), interior (I), and northern periphery (P)</span></span>
<span id="cb25-6"><a href="analysis.html#cb25-6"></a>        <span class="dt">xlab =</span> <span class="st">&quot;Heartland Region&quot;</span>,</span>
<span id="cb25-7"><a href="analysis.html#cb25-7"></a>        <span class="dt">ylab =</span> <span class="st">&quot;Centroid Size&quot;</span>,</span>
<span id="cb25-8"><a href="analysis.html#cb25-8"></a>        <span class="dt">col =</span> <span class="kw">wes_palette</span>(<span class="st">&quot;Moonrise2&quot;</span>),</span>
<span id="cb25-9"><a href="analysis.html#cb25-9"></a>        )</span></code></pre></div>
<p><img src="dalton_files/figure-html/gpa-3.png" width="100%" /></p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="analysis.html#cb26-1"></a>fig.cap =<span class="st"> &quot;Boxplot of centroid size by Heartland region.&quot;</span></span></code></pre></div>
</div>
<div id="principal-components-analysis" class="section level2">
<h2><span class="header-section-number">3.2</span> Principal Components Analysis</h2>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="analysis.html#cb27-1"></a><span class="co"># principal components analysis</span></span>
<span id="cb27-2"><a href="analysis.html#cb27-2"></a>pca&lt;-<span class="kw">gm.prcomp</span>(Y.gpa<span class="op">$</span>coords)</span>
<span id="cb27-3"><a href="analysis.html#cb27-3"></a><span class="kw">summary</span>(pca)</span></code></pre></div>
<pre><code>## 
## Ordination type: Principal Component Analysis 
## Centering and projection: OLS 
## Number of observations 12 
## Number of vectors 12 
## 
## Importance of Components:
##                              Comp1      Comp2        Comp3        Comp4        Comp5
## Eigenvalues            0.009312475 0.00144648 0.0007429635 0.0006407519 0.0003773806
## Proportion of Variance 0.696908125 0.10824876 0.0556004007 0.0479512917 0.0282416477
## Cumulative Proportion  0.696908125 0.80515689 0.8607572868 0.9087085785 0.9369502262
##                               Comp6        Comp7        Comp8        Comp9       Comp10
## Eigenvalues            0.0002591519 0.0002263497 0.0001600805 7.788778e-05 6.264734e-05
## Proportion of Variance 0.0193938872 0.0169391025 0.0119797820 5.828808e-03 4.688275e-03
## Cumulative Proportion  0.9563441134 0.9732832159 0.9852629978 9.910918e-01 9.957801e-01
##                              Comp11       Comp12
## Eigenvalues            5.638891e-05 2.049974e-33
## Proportion of Variance 4.219919e-03 1.534118e-31
## Cumulative Proportion  1.000000e+00 1.000000e+00</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="analysis.html#cb29-1"></a><span class="co"># set plot parameters to plot by heartland in (H) and out (N)</span></span>
<span id="cb29-2"><a href="analysis.html#cb29-2"></a>pch.gps.heart &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">15</span>,<span class="dv">17</span>)[<span class="kw">as.factor</span>(heart)]</span>
<span id="cb29-3"><a href="analysis.html#cb29-3"></a>col.gps.heart &lt;-<span class="st"> </span><span class="kw">wes_palette</span>(<span class="st">&quot;Moonrise2&quot;</span>)[<span class="kw">as.factor</span>(heart)]</span>
<span id="cb29-4"><a href="analysis.html#cb29-4"></a>col.hull &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;#798E87&quot;</span>,<span class="st">&quot;#C27D38&quot;</span>)</span>
<span id="cb29-5"><a href="analysis.html#cb29-5"></a><span class="co"># plot pca by heartland in (H) and out (N)</span></span>
<span id="cb29-6"><a href="analysis.html#cb29-6"></a>pc.plot1 &lt;-<span class="st"> </span><span class="kw">plot</span>(pca, <span class="dt">asp =</span> <span class="dv">1</span>,</span>
<span id="cb29-7"><a href="analysis.html#cb29-7"></a>                  <span class="dt">pch =</span> pch.gps.heart,</span>
<span id="cb29-8"><a href="analysis.html#cb29-8"></a>                  <span class="dt">col =</span> col.gps.heart)</span>
<span id="cb29-9"><a href="analysis.html#cb29-9"></a>                  <span class="kw">shapeHulls</span>(pc.plot1, </span>
<span id="cb29-10"><a href="analysis.html#cb29-10"></a>                             <span class="dt">groups =</span> heart,</span>
<span id="cb29-11"><a href="analysis.html#cb29-11"></a>                             <span class="dt">group.cols =</span> col.hull)</span></code></pre></div>
<p><img src="dalton_files/figure-html/pca-1.png" width="100%" /></p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="analysis.html#cb30-1"></a><span class="co"># set plot parameters to plot by heartland + regions</span></span>
<span id="cb30-2"><a href="analysis.html#cb30-2"></a>pch.gps.hreg &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">15</span>,<span class="dv">17</span>,<span class="dv">18</span>)[<span class="kw">as.factor</span>(hreg)]</span>
<span id="cb30-3"><a href="analysis.html#cb30-3"></a>col.gps.hreg &lt;-<span class="st"> </span><span class="kw">wes_palette</span>(<span class="st">&quot;Moonrise2&quot;</span>)[<span class="kw">as.factor</span>(hreg)]</span>
<span id="cb30-4"><a href="analysis.html#cb30-4"></a>col.hull<span class="fl">.2</span> &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;#798E87&quot;</span>,<span class="st">&quot;#CCC591&quot;</span>,<span class="st">&quot;#C27D38&quot;</span>)</span>
<span id="cb30-5"><a href="analysis.html#cb30-5"></a><span class="co"># plot pca by heartland + regions</span></span>
<span id="cb30-6"><a href="analysis.html#cb30-6"></a>pc.plot2 &lt;-<span class="st"> </span><span class="kw">plot</span>(pca, <span class="dt">asp =</span> <span class="dv">1</span>,</span>
<span id="cb30-7"><a href="analysis.html#cb30-7"></a>                  <span class="dt">pch =</span> pch.gps.hreg,</span>
<span id="cb30-8"><a href="analysis.html#cb30-8"></a>                  <span class="dt">col =</span> col.gps.hreg)</span>
<span id="cb30-9"><a href="analysis.html#cb30-9"></a>                  <span class="kw">shapeHulls</span>(pc.plot2, </span>
<span id="cb30-10"><a href="analysis.html#cb30-10"></a>                             <span class="dt">groups =</span> hreg,</span>
<span id="cb30-11"><a href="analysis.html#cb30-11"></a>                             <span class="dt">group.cols =</span> col.hull<span class="fl">.2</span>)</span></code></pre></div>
<p><img src="dalton_files/figure-html/pca-2.png" width="100%" /></p>
</div>
<div id="define-models" class="section level2">
<h2><span class="header-section-number">3.3</span> Define models</h2>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="analysis.html#cb31-1"></a><span class="co"># allometry</span></span>
<span id="cb31-2"><a href="analysis.html#cb31-2"></a>fit.size &lt;-<span class="st"> </span><span class="kw">procD.lm</span>(shape <span class="op">~</span><span class="st"> </span>size, <span class="dt">data =</span> gdf, <span class="dt">print.progress =</span> <span class="ot">FALSE</span>, <span class="dt">iter =</span> <span class="dv">9999</span>)</span>
<span id="cb31-3"><a href="analysis.html#cb31-3"></a><span class="co"># allometry - common allometry, different means -&gt; heart.out</span></span>
<span id="cb31-4"><a href="analysis.html#cb31-4"></a>fit.sz.cheart &lt;-<span class="st"> </span><span class="kw">procD.lm</span>(shape <span class="op">~</span><span class="st"> </span>size <span class="op">+</span><span class="st"> </span>heart, <span class="dt">data =</span> gdf, <span class="dt">print.progress =</span> <span class="ot">FALSE</span>, <span class="dt">iter =</span> <span class="dv">9999</span>)</span>
<span id="cb31-5"><a href="analysis.html#cb31-5"></a><span class="co"># allometry - unique allometries -&gt; heart.out</span></span>
<span id="cb31-6"><a href="analysis.html#cb31-6"></a>fit.sz.uheart &lt;-<span class="st"> </span><span class="kw">procD.lm</span>(shape <span class="op">~</span><span class="st"> </span>size <span class="op">*</span><span class="st"> </span>heart, <span class="dt">data =</span> gdf, <span class="dt">print.progress =</span> <span class="ot">FALSE</span>, <span class="dt">iter =</span> <span class="dv">9999</span>)</span>
<span id="cb31-7"><a href="analysis.html#cb31-7"></a><span class="co"># allometry - common allometry, different means -&gt; heart.reg</span></span>
<span id="cb31-8"><a href="analysis.html#cb31-8"></a>fit.sz.chreg &lt;-<span class="st"> </span><span class="kw">procD.lm</span>(shape <span class="op">~</span><span class="st"> </span>size <span class="op">+</span><span class="st"> </span>hreg, <span class="dt">data =</span> gdf, <span class="dt">print.progress =</span> <span class="ot">FALSE</span>, <span class="dt">iter =</span> <span class="dv">9999</span>)</span>
<span id="cb31-9"><a href="analysis.html#cb31-9"></a><span class="co"># allometry - unique allometries -&gt; heart.reg</span></span>
<span id="cb31-10"><a href="analysis.html#cb31-10"></a>fit.sz.uhreg &lt;-<span class="st"> </span><span class="kw">procD.lm</span>(shape <span class="op">~</span><span class="st"> </span>size <span class="op">*</span><span class="st"> </span>hreg, <span class="dt">data =</span> gdf, <span class="dt">print.progress =</span> <span class="ot">FALSE</span>, <span class="dt">iter =</span> <span class="dv">9999</span>)</span>
<span id="cb31-11"><a href="analysis.html#cb31-11"></a></span>
<span id="cb31-12"><a href="analysis.html#cb31-12"></a><span class="co"># size as a function of group?</span></span>
<span id="cb31-13"><a href="analysis.html#cb31-13"></a>fit.sizeheart &lt;-<span class="st"> </span><span class="kw">procD.lm</span>(size <span class="op">~</span><span class="st"> </span>heart, <span class="dt">data =</span> gdf, <span class="dt">print.progress =</span> <span class="ot">FALSE</span>, <span class="dt">iter =</span> <span class="dv">9999</span>)</span>
<span id="cb31-14"><a href="analysis.html#cb31-14"></a>fit.sizehreg &lt;-<span class="st"> </span><span class="kw">procD.lm</span>(size <span class="op">~</span><span class="st"> </span>hreg, <span class="dt">data =</span> gdf, <span class="dt">print.progress =</span> <span class="ot">FALSE</span>, <span class="dt">iter =</span> <span class="dv">9999</span>)</span>
<span id="cb31-15"><a href="analysis.html#cb31-15"></a></span>
<span id="cb31-16"><a href="analysis.html#cb31-16"></a><span class="co"># shape as a function of group?</span></span>
<span id="cb31-17"><a href="analysis.html#cb31-17"></a>fit.shapeheart &lt;-<span class="st"> </span><span class="kw">procD.lm</span>(shape <span class="op">~</span><span class="st"> </span>heart, <span class="dt">data =</span> gdf, <span class="dt">print.progress =</span> <span class="ot">FALSE</span>, <span class="dt">iter =</span> <span class="dv">9999</span>)</span>
<span id="cb31-18"><a href="analysis.html#cb31-18"></a>fit.shapehreg &lt;-<span class="st"> </span><span class="kw">procD.lm</span>(shape <span class="op">~</span><span class="st"> </span>hreg, <span class="dt">data =</span> gdf, <span class="dt">print.progress =</span> <span class="ot">FALSE</span>, <span class="dt">iter =</span> <span class="dv">9999</span>)</span></code></pre></div>
</div>
<div id="allometry" class="section level2">
<h2><span class="header-section-number">3.4</span> Allometry</h2>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="analysis.html#cb32-1"></a><span class="co"># allometry - does shape change with size?</span></span>
<span id="cb32-2"><a href="analysis.html#cb32-2"></a><span class="kw">anova</span>(fit.size)</span></code></pre></div>
<pre><code>## 
## Analysis of Variance, using Residual Randomization
## Permutation procedure: Randomization of null model residuals 
## Number of permutations: 10000 
## Estimation method: Ordinary Least Squares 
## Sums of Squares and Cross-products: Type I 
## Effect sizes (Z) based on F distributions
## 
##           Df       SS       MS   Rsq      F      Z Pr(&gt;F)   
## size       1 0.058354 0.058354 0.397 6.5837 2.6047 0.0056 **
## Residuals 10 0.088634 0.008863 0.603                        
## Total     11 0.146988                                       
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Call: procD.lm(f1 = shape ~ size, iter = 9999, data = gdf, print.progress = FALSE)</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="analysis.html#cb34-1"></a><span class="co"># heart.out</span></span>
<span id="cb34-2"><a href="analysis.html#cb34-2"></a><span class="kw">anova</span>(fit.sz.cheart)</span></code></pre></div>
<pre><code>## 
## Analysis of Variance, using Residual Randomization
## Permutation procedure: Randomization of null model residuals 
## Number of permutations: 10000 
## Estimation method: Ordinary Least Squares 
## Sums of Squares and Cross-products: Type I 
## Effect sizes (Z) based on F distributions
## 
##           Df       SS       MS     Rsq      F      Z Pr(&gt;F)   
## size       1 0.058354 0.058354 0.39700 7.3641 2.7129 0.0036 **
## heart      1 0.017317 0.017317 0.11781 2.1854 1.3260 0.1107   
## Residuals  9 0.071317 0.007924 0.48519                        
## Total     11 0.146988                                         
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Call: procD.lm(f1 = shape ~ size + heart, iter = 9999, data = gdf,      print.progress = FALSE)</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="analysis.html#cb36-1"></a><span class="kw">anova</span>(fit.sz.uheart)</span></code></pre></div>
<pre><code>## 
## Analysis of Variance, using Residual Randomization
## Permutation procedure: Randomization of null model residuals 
## Number of permutations: 10000 
## Estimation method: Ordinary Least Squares 
## Sums of Squares and Cross-products: Type I 
## Effect sizes (Z) based on F distributions
## 
##            Df       SS       MS     Rsq      F      Z Pr(&gt;F)   
## size        1 0.058354 0.058354 0.39700 8.1258 2.7877 0.0027 **
## heart       1 0.017317 0.017317 0.11781 2.4114 1.4502 0.0930 . 
## size:heart  1 0.013867 0.013867 0.09434 1.9310 1.1401 0.1419   
## Residuals   8 0.057450 0.007181 0.39085                        
## Total      11 0.146988                                         
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Call: procD.lm(f1 = shape ~ size * heart, iter = 9999, data = gdf,      print.progress = FALSE)</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="analysis.html#cb38-1"></a><span class="kw">anova</span>(fit.sz.cheart, fit.sz.uheart, <span class="dt">print.progress =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<pre><code>## 
## Analysis of Variance, using Residual Randomization
## Permutation procedure: Randomization of null model residuals 
## Number of permutations: 10000 
## Estimation method: Ordinary Least Squares 
## Effect sizes (Z) based on F distributions
## 
##                             ResDf Df      RSS       SS       MS     Rsq     F      Z      P
## shape ~ size + heart (Null)     9  1 0.071317                   0.00000                    
## shape ~ size * heart            8  1 0.057450 0.013867 0.013867 0.09434 1.931 1.1401 0.1419
## Total                          11    0.146988                                              
##                             Pr(&gt;F)
## shape ~ size + heart (Null)       
## shape ~ size * heart              
## Total</code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="analysis.html#cb40-1"></a><span class="co"># heart.reg</span></span>
<span id="cb40-2"><a href="analysis.html#cb40-2"></a><span class="kw">anova</span>(fit.sz.chreg)</span></code></pre></div>
<pre><code>## 
## Analysis of Variance, using Residual Randomization
## Permutation procedure: Randomization of null model residuals 
## Number of permutations: 10000 
## Estimation method: Ordinary Least Squares 
## Sums of Squares and Cross-products: Type I 
## Effect sizes (Z) based on F distributions
## 
##           Df       SS       MS     Rsq      F       Z Pr(&gt;F)   
## size       1 0.058354 0.058354 0.39700 7.0962 2.65162 0.0048 **
## hreg       2 0.022849 0.011424 0.15544 1.3893 0.67602 0.2522   
## Residuals  8 0.065786 0.008223 0.44756                         
## Total     11 0.146988                                          
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Call: procD.lm(f1 = shape ~ size + hreg, iter = 9999, data = gdf, print.progress = FALSE)</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="analysis.html#cb42-1"></a><span class="kw">anova</span>(fit.sz.uhreg)</span></code></pre></div>
<pre><code>## 
## Analysis of Variance, using Residual Randomization
## Permutation procedure: Randomization of null model residuals 
## Number of permutations: 10000 
## Estimation method: Ordinary Least Squares 
## Sums of Squares and Cross-products: Type I 
## Effect sizes (Z) based on F distributions
## 
##           Df       SS       MS     Rsq      F       Z Pr(&gt;F)   
## size       1 0.058354 0.058354 0.39700 7.2700 2.58801 0.0058 **
## hreg       2 0.022849 0.011424 0.15544 1.4233 0.68139 0.2490   
## size:hreg  2 0.017626 0.008813 0.11991 1.0980 0.27407 0.3773   
## Residuals  6 0.048160 0.008027 0.32764                         
## Total     11 0.146988                                          
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Call: procD.lm(f1 = shape ~ size * hreg, iter = 9999, data = gdf, print.progress = FALSE)</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="analysis.html#cb44-1"></a><span class="kw">anova</span>(fit.sz.chreg, fit.sz.uhreg, <span class="dt">print.progress =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<pre><code>## 
## Analysis of Variance, using Residual Randomization
## Permutation procedure: Randomization of null model residuals 
## Number of permutations: 10000 
## Estimation method: Ordinary Least Squares 
## Effect sizes (Z) based on F distributions
## 
##                            ResDf Df      RSS       SS       MS     Rsq     F       Z      P
## shape ~ size + hreg (Null)     8  1 0.065786                   0.00000                     
## shape ~ size * hreg            6  2 0.048160 0.017626 0.008813 0.11991 1.098 0.27407 0.3773
## Total                         11    0.146988                                               
##                            Pr(&gt;F)
## shape ~ size + hreg (Null)       
## shape ~ size * hreg              
## Total</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="analysis.html#cb46-1"></a><span class="co"># allometry plots</span></span>
<span id="cb46-2"><a href="analysis.html#cb46-2"></a><span class="co"># regscore (Drake and Klingenberg 2008)</span></span>
<span id="cb46-3"><a href="analysis.html#cb46-3"></a><span class="kw">plot</span>(fit.size, <span class="dt">type =</span> <span class="st">&quot;regression&quot;</span>, <span class="dt">reg.type =</span> <span class="st">&quot;RegScore&quot;</span>, <span class="dt">predictor =</span> <span class="kw">log</span>(gdf<span class="op">$</span>size), <span class="dt">pch =</span> pch.gps.heart, <span class="dt">col =</span> col.gps.heart)</span></code></pre></div>
<p><img src="dalton_files/figure-html/allometry-1.png" width="100%" /></p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="analysis.html#cb47-1"></a><span class="kw">plot</span>(fit.size, <span class="dt">type =</span> <span class="st">&quot;regression&quot;</span>, <span class="dt">reg.type =</span> <span class="st">&quot;RegScore&quot;</span>, <span class="dt">predictor =</span> <span class="kw">log</span>(gdf<span class="op">$</span>size), <span class="dt">pch =</span> pch.gps.hreg, <span class="dt">col =</span> col.gps.hreg)</span></code></pre></div>
<p><img src="dalton_files/figure-html/allometry-2.png" width="100%" /></p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="analysis.html#cb48-1"></a><span class="co"># common allometric component (Mitteroecker 2004)</span></span>
<span id="cb48-2"><a href="analysis.html#cb48-2"></a><span class="kw">plotAllometry</span>(fit.size, <span class="dt">size =</span> gdf<span class="op">$</span>size, <span class="dt">logsz =</span> <span class="ot">TRUE</span>, <span class="dt">method =</span> <span class="st">&quot;CAC&quot;</span>, <span class="dt">pch =</span> pch.gps.heart, <span class="dt">col =</span> col.gps.heart)</span></code></pre></div>
<p><img src="dalton_files/figure-html/allometry-3.png" width="100%" /></p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="analysis.html#cb49-1"></a><span class="kw">plotAllometry</span>(fit.size, <span class="dt">size =</span> gdf<span class="op">$</span>size, <span class="dt">logsz =</span> <span class="ot">TRUE</span>, <span class="dt">method =</span> <span class="st">&quot;CAC&quot;</span>, <span class="dt">pch =</span> pch.gps.hreg, <span class="dt">col =</span> col.gps.hreg)</span></code></pre></div>
<p><img src="dalton_files/figure-html/allometry-4.png" width="100%" /></p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="analysis.html#cb50-1"></a><span class="co"># size-shape pca (Mitteroecker 2004)</span></span>
<span id="cb50-2"><a href="analysis.html#cb50-2"></a><span class="kw">plotAllometry</span>(fit.size, <span class="dt">size =</span> gdf<span class="op">$</span>size, <span class="dt">logsz =</span> <span class="ot">TRUE</span>, <span class="dt">method =</span> <span class="st">&quot;size.shape&quot;</span>, <span class="dt">pch =</span> pch.gps.heart, <span class="dt">col =</span> col.gps.heart)</span></code></pre></div>
<p><img src="dalton_files/figure-html/allometry-5.png" width="100%" /></p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="analysis.html#cb51-1"></a><span class="kw">plotAllometry</span>(fit.size, <span class="dt">size =</span> gdf<span class="op">$</span>size, <span class="dt">logsz =</span> <span class="ot">TRUE</span>, <span class="dt">method =</span> <span class="st">&quot;size.shape&quot;</span>, <span class="dt">pch =</span> pch.gps.hreg, <span class="dt">col =</span> col.gps.hreg)</span></code></pre></div>
<p><img src="dalton_files/figure-html/allometry-6.png" width="100%" /></p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="analysis.html#cb52-1"></a><span class="co"># predline (Adams and Nistri 2010)</span></span>
<span id="cb52-2"><a href="analysis.html#cb52-2"></a><span class="kw">plotAllometry</span>(fit.sz.uheart, <span class="dt">size =</span> gdf<span class="op">$</span>size, <span class="dt">logsz =</span> <span class="ot">TRUE</span>, <span class="dt">method =</span> <span class="st">&quot;PredLine&quot;</span>, <span class="dt">pch =</span> pch.gps.heart, <span class="dt">col =</span> col.gps.heart)</span></code></pre></div>
<p><img src="dalton_files/figure-html/allometry-7.png" width="100%" /></p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="analysis.html#cb53-1"></a><span class="kw">plotAllometry</span>(fit.sz.uhreg, <span class="dt">size =</span> gdf<span class="op">$</span>size, <span class="dt">logsz =</span> <span class="ot">TRUE</span>, <span class="dt">method =</span> <span class="st">&quot;PredLine&quot;</span>, <span class="dt">pch =</span> pch.gps.hreg, <span class="dt">col =</span> col.gps.hreg)</span></code></pre></div>
<p><img src="dalton_files/figure-html/allometry-8.png" width="100%" /></p>
</div>
<div id="sizeshape-group" class="section level2">
<h2><span class="header-section-number">3.5</span> Size/Shape ~ Group?</h2>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="analysis.html#cb54-1"></a><span class="co"># ANOVA: does Dalton point size differ in/out of heartland?</span></span>
<span id="cb54-2"><a href="analysis.html#cb54-2"></a><span class="kw">anova</span>(fit.sizeheart)</span></code></pre></div>
<pre><code>## 
## Analysis of Variance, using Residual Randomization
## Permutation procedure: Randomization of null model residuals 
## Number of permutations: 10000 
## Estimation method: Ordinary Least Squares 
## Sums of Squares and Cross-products: Type I 
## Effect sizes (Z) based on F distributions
## 
##           Df     SS      MS     Rsq      F      Z  Pr(&gt;F)  
## heart      1 1439.8 1439.75 0.24911 3.3175 1.0579 0.09605 .
## Residuals 10 4339.9  433.99 0.75089                        
## Total     11 5779.7                                        
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Call: procD.lm(f1 = size ~ heart, iter = 9999, data = gdf, print.progress = FALSE)</code></pre>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="analysis.html#cb56-1"></a><span class="co"># ANOVA: does Dalton point shape differ in/out of Heartland?</span></span>
<span id="cb56-2"><a href="analysis.html#cb56-2"></a><span class="kw">anova</span>(fit.shapeheart)</span></code></pre></div>
<pre><code>## 
## Analysis of Variance, using Residual Randomization
## Permutation procedure: Randomization of null model residuals 
## Number of permutations: 10000 
## Estimation method: Ordinary Least Squares 
## Sums of Squares and Cross-products: Type I 
## Effect sizes (Z) based on F distributions
## 
##           Df      SS       MS     Rsq      F      Z Pr(&gt;F)  
## heart      1 0.04698 0.046980 0.31962 4.6977 2.1383 0.0213 *
## Residuals 10 0.10001 0.010001 0.68038                       
## Total     11 0.14699                                        
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Call: procD.lm(f1 = shape ~ heart, iter = 9999, data = gdf, print.progress = FALSE)</code></pre>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="analysis.html#cb58-1"></a><span class="co"># ANOVA: does Dalton point sizes differ across heartland regions?</span></span>
<span id="cb58-2"><a href="analysis.html#cb58-2"></a><span class="kw">anova</span>(fit.sizehreg)</span></code></pre></div>
<pre><code>## 
## Analysis of Variance, using Residual Randomization
## Permutation procedure: Randomization of null model residuals 
## Number of permutations: 10000 
## Estimation method: Ordinary Least Squares 
## Sums of Squares and Cross-products: Type I 
## Effect sizes (Z) based on F distributions
## 
##           Df     SS     MS     Rsq      F       Z Pr(&gt;F)
## hreg       2 1475.3 737.63 0.25525 1.5423 0.65995 0.2554
## Residuals  9 4304.4 478.27 0.74475                      
## Total     11 5779.7                                     
## 
## Call: procD.lm(f1 = size ~ hreg, iter = 9999, data = gdf, print.progress = FALSE)</code></pre>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="analysis.html#cb60-1"></a><span class="co"># pairwise comparison of LS means = which differ?</span></span>
<span id="cb60-2"><a href="analysis.html#cb60-2"></a>sz.hreg &lt;-<span class="st"> </span><span class="kw">pairwise</span>(fit.sizehreg, <span class="dt">groups =</span> qdata<span class="op">$</span>heart.reg)</span>
<span id="cb60-3"><a href="analysis.html#cb60-3"></a><span class="kw">summary</span>(sz.hreg, <span class="dt">confidence =</span> <span class="fl">0.95</span>, <span class="dt">test.type =</span> <span class="st">&quot;dist&quot;</span>)</span></code></pre></div>
<pre><code>## 
## Pairwise comparisons
## 
## Groups: H I P 
## 
## RRPP: 10000 permutations
## 
## LS means:
## Vectors hidden (use show.vectors = TRUE to view)
## 
## Pairwise distances between means, plus statistics
##             d UCL (95%)          Z Pr &gt; d
## H:I 21.129079  31.37133  0.8383642 0.2068
## H:P 25.342765  31.14089  1.2981949 0.1210
## I:P  4.213687  30.91455 -0.9357657 0.7977</code></pre>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="analysis.html#cb62-1"></a><span class="co"># pairwise distance between variances = standardization?</span></span>
<span id="cb62-2"><a href="analysis.html#cb62-2"></a><span class="kw">summary</span>(sz.hreg, <span class="dt">confidence =</span> <span class="fl">0.95</span>, <span class="dt">test.type =</span> <span class="st">&quot;var&quot;</span>)</span></code></pre></div>
<pre><code>## 
## Pairwise comparisons
## 
## Groups: H I P 
## 
## RRPP: 10000 permutations
## 
## 
## Observed variances by group
## 
##        H        I        P 
## 278.3626 338.1850 459.5544 
## 
## Pairwise distances between variances, plus statistics
##             d UCL (95%)          Z Pr &gt; d
## H:I  59.82237  539.7653 -1.0838680 0.8549
## H:P 181.19176  537.6419 -0.3412214 0.5737
## I:P 121.36939  536.7711 -0.7061467 0.7036</code></pre>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="analysis.html#cb64-1"></a><span class="co"># ANOVA: does Dalton point shape differ across heartland + regions?</span></span>
<span id="cb64-2"><a href="analysis.html#cb64-2"></a><span class="kw">anova</span>(fit.shapehreg)</span></code></pre></div>
<pre><code>## 
## Analysis of Variance, using Residual Randomization
## Permutation procedure: Randomization of null model residuals 
## Number of permutations: 10000 
## Estimation method: Ordinary Least Squares 
## Sums of Squares and Cross-products: Type I 
## Effect sizes (Z) based on F distributions
## 
##           Df       SS       MS     Rsq     F      Z  Pr(&gt;F)  
## hreg       2 0.052684 0.026342 0.35842 2.514 1.5203 0.07175 .
## Residuals  9 0.094304 0.010478 0.64158                       
## Total     11 0.146988                                        
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Call: procD.lm(f1 = shape ~ hreg, iter = 9999, data = gdf, print.progress = FALSE)</code></pre>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="analysis.html#cb66-1"></a><span class="co"># pairwise comparison of LS means = which differ?</span></span>
<span id="cb66-2"><a href="analysis.html#cb66-2"></a>sh.hreg &lt;-<span class="st"> </span><span class="kw">pairwise</span>(fit.shapehreg, <span class="dt">groups =</span> qdata<span class="op">$</span>heart.reg)</span>
<span id="cb66-3"><a href="analysis.html#cb66-3"></a><span class="kw">summary</span>(sh.hreg, <span class="dt">confidence =</span> <span class="fl">0.95</span>, <span class="dt">test.type =</span> <span class="st">&quot;dist&quot;</span>)</span></code></pre></div>
<pre><code>## 
## Pairwise comparisons
## 
## Groups: H I P 
## 
## RRPP: 10000 permutations
## 
## LS means:
## Vectors hidden (use show.vectors = TRUE to view)
## 
## Pairwise distances between means, plus statistics
##              d UCL (95%)          Z Pr &gt; d
## H:I 0.12340118 0.1390142  1.5238546 0.0951
## H:P 0.14640107 0.1363220  2.3425328 0.0303
## I:P 0.05340121 0.1368627 -0.7453086 0.7464</code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="analysis.html#cb68-1"></a><span class="co"># pairwise distance between variances = standardization?</span></span>
<span id="cb68-2"><a href="analysis.html#cb68-2"></a><span class="kw">summary</span>(sh.hreg, <span class="dt">confidence =</span> <span class="fl">0.95</span>, <span class="dt">test.type =</span> <span class="st">&quot;var&quot;</span>)</span></code></pre></div>
<pre><code>## 
## Pairwise comparisons
## 
## Groups: H I P 
## 
## RRPP: 10000 permutations
## 
## 
## Observed variances by group
## 
##           H           I           P 
## 0.013484388 0.003353103 0.006738604 
## 
## Pairwise distances between variances, plus statistics
##               d  UCL (95%)          Z Pr &gt; d
## H:I 0.010131285 0.01094240  1.6093311 0.0739
## H:P 0.006745784 0.01093859  0.5395385 0.2904
## I:P 0.003385501 0.01090853 -0.5006636 0.6352</code></pre>
</div>
<div id="morphological-disparity" class="section level2">
<h2><span class="header-section-number">3.6</span> Morphological disparity</h2>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="analysis.html#cb70-1"></a><span class="co"># morphological disparity: does Dalton point size display greater variation among individuals?</span></span>
<span id="cb70-2"><a href="analysis.html#cb70-2"></a><span class="co"># in/out of heartland</span></span>
<span id="cb70-3"><a href="analysis.html#cb70-3"></a><span class="kw">morphol.disparity</span>(fit.sizeheart, <span class="dt">groups =</span> qdata<span class="op">$</span>heart.out, <span class="dt">data =</span> gdf, <span class="dt">print.progress =</span> <span class="ot">FALSE</span>, <span class="dt">iter =</span> <span class="dv">9999</span>)</span></code></pre></div>
<pre><code>## 
## Call:
## morphol.disparity(f1 = fit.sizeheart, groups = qdata$heart.out,  
##     iter = 9999, data = gdf, print.progress = FALSE) 
## 
## 
## 
## Randomized Residual Permutation Procedure Used
## 10000 Permutations
## 
## Procrustes variances for defined groups
##        H        N 
## 278.3626 403.3085 
## 
## 
## Pairwise absolute differences between variances
##          H        N
## H   0.0000 124.9459
## N 124.9459   0.0000
## 
## 
## P-Values
##        H      N
## H 1.0000 0.6021
## N 0.6021 1.0000</code></pre>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="analysis.html#cb72-1"></a><span class="co"># heartland + regions</span></span>
<span id="cb72-2"><a href="analysis.html#cb72-2"></a><span class="kw">morphol.disparity</span>(fit.sizehreg, <span class="dt">groups =</span> qdata<span class="op">$</span>heart.reg, <span class="dt">data =</span> gdf, <span class="dt">print.progress =</span> <span class="ot">FALSE</span>, <span class="dt">iter =</span> <span class="dv">9999</span>)</span></code></pre></div>
<pre><code>## 
## Call:
## morphol.disparity(f1 = fit.sizehreg, groups = qdata$heart.reg,  
##     iter = 9999, data = gdf, print.progress = FALSE) 
## 
## 
## 
## Randomized Residual Permutation Procedure Used
## 10000 Permutations
## 
## Procrustes variances for defined groups
##        H        I        P 
## 278.3626 338.1850 459.5544 
## 
## 
## Pairwise absolute differences between variances
##           H         I        P
## H   0.00000  59.82237 181.1918
## I  59.82237   0.00000 121.3694
## P 181.19176 121.36939   0.0000
## 
## 
## P-Values
##        H      I      P
## H 1.0000 0.8549 0.5737
## I 0.8549 1.0000 0.7036
## P 0.5737 0.7036 1.0000</code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="analysis.html#cb74-1"></a><span class="co"># morphological disparity: does Dalton point shape display greater variation among individuals?</span></span>
<span id="cb74-2"><a href="analysis.html#cb74-2"></a><span class="co"># in/out of heartland</span></span>
<span id="cb74-3"><a href="analysis.html#cb74-3"></a><span class="kw">morphol.disparity</span>(fit.shapeheart, <span class="dt">groups =</span> qdata<span class="op">$</span>heart.out, <span class="dt">data =</span> gdf, <span class="dt">print.progress =</span> <span class="ot">FALSE</span>, <span class="dt">iter =</span> <span class="dv">9999</span>)</span></code></pre></div>
<pre><code>## 
## Call:
## morphol.disparity(f1 = fit.shapeheart, groups = qdata$heart.out,  
##     iter = 9999, data = gdf, print.progress = FALSE) 
## 
## 
## 
## Randomized Residual Permutation Procedure Used
## 10000 Permutations
## 
## Procrustes variances for defined groups
##           H           N 
## 0.013484388 0.005758776 
## 
## 
## Pairwise absolute differences between variances
##             H           N
## H 0.000000000 0.007725612
## N 0.007725612 0.000000000
## 
## 
## P-Values
##        H      N
## H 1.0000 0.1013
## N 0.1013 1.0000</code></pre>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="analysis.html#cb76-1"></a><span class="co"># heartland + regions</span></span>
<span id="cb76-2"><a href="analysis.html#cb76-2"></a><span class="kw">morphol.disparity</span>(fit.shapehreg, <span class="dt">groups =</span> qdata<span class="op">$</span>heart.reg, <span class="dt">data =</span> gdf, <span class="dt">print.progress =</span> <span class="ot">FALSE</span>, <span class="dt">iter =</span> <span class="dv">9999</span>)</span></code></pre></div>
<pre><code>## 
## Call:
## morphol.disparity(f1 = fit.shapehreg, groups = qdata$heart.reg,  
##     iter = 9999, data = gdf, print.progress = FALSE) 
## 
## 
## 
## Randomized Residual Permutation Procedure Used
## 10000 Permutations
## 
## Procrustes variances for defined groups
##           H           I           P 
## 0.013484388 0.003353103 0.006738604 
## 
## 
## Pairwise absolute differences between variances
##             H           I           P
## H 0.000000000 0.010131285 0.006745784
## I 0.010131285 0.000000000 0.003385501
## P 0.006745784 0.003385501 0.000000000
## 
## 
## P-Values
##        H      I      P
## H 1.0000 0.0739 0.2904
## I 0.0739 1.0000 0.6352
## P 0.2904 0.6352 1.0000</code></pre>
</div>
<div id="mean-shapes" class="section level2">
<h2><span class="header-section-number">3.7</span> Mean shapes</h2>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="analysis.html#cb78-1"></a><span class="co"># subset landmark coordinates to produce mean shapes by site</span></span>
<span id="cb78-2"><a href="analysis.html#cb78-2"></a><span class="co"># new.coords &lt;- coords.subset(A = Y.gpa$coords, group = qdata$heart)</span></span>
<span id="cb78-3"><a href="analysis.html#cb78-3"></a><span class="co"># names(new.coords)</span></span>
<span id="cb78-4"><a href="analysis.html#cb78-4"></a><span class="co"># group shape means</span></span>
<span id="cb78-5"><a href="analysis.html#cb78-5"></a><span class="co"># mean &lt;- lapply(new.coords, mshape)</span></span>
<span id="cb78-6"><a href="analysis.html#cb78-6"></a><span class="co"># plot(mean$vv)</span></span>
<span id="cb78-7"><a href="analysis.html#cb78-7"></a><span class="co"># mean shapes</span></span>
<span id="cb78-8"><a href="analysis.html#cb78-8"></a><span class="co">#knitr::include_graphics(&#39;images/dalton-mshape.png&#39;)</span></span>
<span id="cb78-9"><a href="analysis.html#cb78-9"></a><span class="co">#fig.cap = &quot;Mean shapes for Dalton points by region&quot;</span></span>
<span id="cb78-10"><a href="analysis.html#cb78-10"></a><span class="co"># end of code</span></span></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="landmark-sampling-evaluation-curve.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="open.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["dalton.pdf", "dalton.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
