[
["analysis-of-dalton-morphology.html", "Chapter 4 Analysis of Dalton morphology 4.1 Load packages + data 4.2 Generalized Procrustes Analysis 4.3 Principal Components Analysis 4.4 Define models 4.5 Allometry 4.6 Test Hypothesis 1 (Geo GM) 4.7 Test Hypothesis 2 (Geo GM) 4.8 Test Hypothesis 3 (Techno GM) 4.9 Test Hypothesis 4 (Techno GM) 4.10 Morphological integration", " Chapter 4 Analysis of Dalton morphology 4.1 Load packages + data # load packages # devtools::install_github(&quot;geomorphR/geomorph&quot;, ref = &quot;Stable&quot;, build_vignettes = TRUE) library(geomorph) ## Loading required package: RRPP ## Loading required package: rgl library(tidyverse) ## -- Attaching packages ------------------------------------------------------------------------- tidyverse 1.3.0 -- ## v ggplot2 3.3.2 v purrr 0.3.4 ## v tibble 3.0.3 v dplyr 1.0.2 ## v tidyr 1.1.2 v stringr 1.4.0 ## v readr 1.3.1 v forcats 0.5.0 ## -- Conflicts ---------------------------------------------------------------------------- tidyverse_conflicts() -- ## x dplyr::filter() masks stats::filter() ## x dplyr::lag() masks stats::lag() library(wesanderson) # setwd setwd(getwd()) # read GM data source(&#39;readmulti.csv.R&#39;) # read .csv files setwd(&quot;./data&quot;) filelist &lt;- list.files(pattern = &quot;.csv&quot;) coords &lt;- readmulti.csv(filelist) setwd(&quot;../&quot;) # read qualitative data qdata &lt;- read.csv(&quot;qdata.csv&quot;, header = TRUE, row.names = 1) qdata &lt;- qdata[match(dimnames(coords)[[3]],rownames(qdata)),] # print qdata knitr::kable(qdata, align = &quot;cccc&quot;, caption = &quot;Attributes included in qdata.&quot;) (#tab:load.data)Attributes included in qdata. heart.out heart.reg bev bev.type 11AI225 H H y unifacial.bimarginal 11HE445 N P n no.bevel HK49_1462 N I n no.bevel HK49_2 N I n no.bevel HK49_3022 N I n no.bevel HK49_3823 N I n no.bevel HK49_4 N I n no.bevel HK49_5928 N I y alternate HK49_5961 N I n no.bevel HK49_7 N I y unifacial.bimarginal KeilMangold10 H H y alternate KeilMangold13 H H y alternate KeilMangold14 H H y alternate KeilMangold17 H H y alternate KeilMangold24 H H y alternate KeilMangold3 H H y alternate KeilMangold42 H H y alternate KeilMangold64 H H y alternate KeilMangold8 H H y alternate KeilMangold90 H H y alternate Kinzer46 N P n no.bevel Kinzer49 N P n no.bevel Kinzer50 N P y alternate Leprechaun11MS1983FSI800-5 H H y alternate MA1699p1 H H y alternate MA1699p3 H H n no.bevel McL4_158 N I y alternate McL4_614 N I n no.bevel McL7_101 N I n no.bevel McL7_168 N I n no.bevel Nochta11MS128BFSI267-1 H H y alternate Nochta11MS128bFSIPP1001 H H y alternate Nochta11MS128BFSIPP2495 H H y alternate Nochta11MS128BFSIPP3305 H H y alternate Nochta11MS12BFIS800-168 H H y alternate OH1_176 N I n no.bevel ReedVoss2 H H y alternate TR10_4 N I n no.bevel Welton1 N P n no.bevel Welton2 N P y alternate Welton5 N P y unifacial.bimarginal 4.2 Generalized Procrustes Analysis Landmark data were aligned to a global coordinate system (Kendall 1981, 1984; Slice 2001), achieved through generalized Procrustes superimposition (Rohlf and Slice 1990) performed in R 4.0.2 (R Core Development Team, 2020) using the geomorph library v. 3.3.1 (Adams et al. 2017; Adams and Ot√°rola-Castillo 2013). Procrustes superimposition translates, scales, and rotates the coordinate data to allow for comparisons among objects (Gower 1975; Rohlf and Slice 1990). The geomorph package uses a partial Procrustes superimposition that projects the aligned specimens into tangent space subsequent to alignment in preparation for the use of multivariate methods that assume linear space (Rohlf 1999; Slice 2001). # gpa Y.gpa &lt;- gpagen(coords, PrinAxes = TRUE, ProcD = TRUE, Proj = TRUE, print.progress = FALSE) # output + consensus configuration coords Y.gpa ## ## Call: ## gpagen(A = coords, PrinAxes = TRUE, ProcD = TRUE, Proj = TRUE, ## print.progress = FALSE) ## ## ## ## Generalized Procrustes Analysis ## with Partial Procrustes Superimposition ## ## 34 fixed landmarks ## 0 semilandmarks (sliders) ## 3-dimensional landmarks ## 3 GPA iterations to converge ## ## ## Consensus (mean) Configuration ## ## X Y Z ## 1 -3.263635e-01 -0.0013385403 -0.0009684616 ## 2 2.192495e-01 0.1172356087 -0.0012141590 ## 3 2.150290e-01 -0.1225383686 0.0008116295 ## 4 8.278056e-02 0.1197457917 -0.0013937141 ## 5 8.133923e-02 -0.1172897761 0.0001947492 ## 6 1.963424e-01 -0.0022811090 0.0003911166 ## 7 -2.450091e-01 0.0465479319 0.0015677849 ## 8 -1.634113e-01 0.0697823147 0.0007021236 ## 9 -8.174435e-02 0.0846137860 0.0006888902 ## 10 -6.112658e-05 0.0994269516 -0.0004149999 ## 11 1.431415e-01 0.1132463238 -0.0013320999 ## 12 2.161750e-01 0.0594104623 -0.0011749763 ## 13 2.174165e-01 -0.0643647311 0.0004647941 ## 14 1.357850e-01 -0.1134541944 -0.0004054045 ## 15 1.188792e-03 -0.0956031163 -0.0012146496 ## 16 -8.064685e-02 -0.0821218472 -0.0020393529 ## 17 -1.625181e-01 -0.0688073013 -0.0014644822 ## 18 -2.434044e-01 -0.0477832555 -0.0015146358 ## 19 -2.446820e-01 -0.0008732904 0.0211067380 ## 20 -1.629505e-01 -0.0003073281 0.0280988610 ## 21 -8.120893e-02 0.0002088046 0.0310869847 ## 22 5.697717e-04 0.0007661819 0.0313819860 ## 23 8.199898e-02 0.0013216730 0.0282438977 ## 24 1.390420e-01 -0.0004594756 0.0214652460 ## 25 1.395028e-01 -0.0005631335 -0.0206368953 ## 26 8.211085e-02 0.0011924026 -0.0268781908 ## 27 6.967301e-04 0.0006908318 -0.0297999335 ## 28 -8.106954e-02 0.0001985095 -0.0293716160 ## 29 -1.628592e-01 -0.0003465058 -0.0272496204 ## 30 -2.446260e-01 -0.0008518792 -0.0207895420 ## 31 8.243056e-02 0.0637655712 0.0235284582 ## 32 8.161249e-02 -0.0611404804 0.0242257955 ## 33 8.166948e-02 -0.0612214348 -0.0234904892 ## 34 8.247369e-02 0.0631926222 -0.0226058321 # geomorph data frame gdf &lt;- geomorph.data.frame(shape = Y.gpa$coords, size = Y.gpa$Csize, heart = qdata$heart.out, hreg = qdata$heart.reg, bev.1 = qdata$bev, bev.2 = qdata$bev.type) # plot consensus configuration par(mfrow=c(1, 3)) plot(Y.gpa$consensus[,c(&quot;Y&quot;, &quot;X&quot;)], pch=20) plot(Y.gpa$consensus[,c(&quot;Z&quot;, &quot;X&quot;)], pch=20) plot(Y.gpa$consensus[,c(&quot;Z&quot;, &quot;Y&quot;)], pch=20) Figure 4.1: 2D plot of 3D consensus configuration. # render 3d gpa plot #plot(Y.gpa) # gpa plot # knitr::include_graphics(&#39;images/gpa3d.png&#39;) 4.2.1 Boxplot attributes # add centroid size to qdata qdata$csz &lt;- Y.gpa$Csize # print updated qdata with centroid size knitr::kable(qdata, align = &quot;ccccc&quot;, caption = &quot;Modified attributes included in qdata.&quot;) (#tab:box.attr)Modified attributes included in qdata. heart.out heart.reg bev bev.type csz 11AI225 H H y unifacial.bimarginal 111.17971 11HE445 N P n no.bevel 125.68376 HK49_1462 N I n no.bevel 106.02942 HK49_2 N I n no.bevel 77.88910 HK49_3022 N I n no.bevel 100.02205 HK49_3823 N I n no.bevel 112.93309 HK49_4 N I n no.bevel 118.11018 HK49_5928 N I y alternate 121.33863 HK49_5961 N I n no.bevel 102.86813 HK49_7 N I y unifacial.bimarginal 104.40945 KeilMangold10 H H y alternate 126.59440 KeilMangold13 H H y alternate 143.47265 KeilMangold14 H H y alternate 147.46915 KeilMangold17 H H y alternate 105.16645 KeilMangold24 H H y alternate 111.45604 KeilMangold3 H H y alternate 126.88410 KeilMangold42 H H y alternate 116.67686 KeilMangold64 H H y alternate 139.46602 KeilMangold8 H H y alternate 104.38197 KeilMangold90 H H y alternate 110.38118 Kinzer46 N P n no.bevel 92.72096 Kinzer49 N P n no.bevel 86.46909 Kinzer50 N P y alternate 86.54094 Leprechaun11MS1983FSI800-5 H H y alternate 193.20788 MA1699p1 H H y alternate 162.77316 MA1699p3 H H n no.bevel 134.02270 McL4_158 N I y alternate 72.68131 McL4_614 N I n no.bevel 95.77598 McL7_101 N I n no.bevel 82.38421 McL7_168 N I n no.bevel 101.23743 Nochta11MS128BFSI267-1 H H y alternate 104.48051 Nochta11MS128bFSIPP1001 H H y alternate 164.44493 Nochta11MS128BFSIPP2495 H H y alternate 91.73625 Nochta11MS128BFSIPP3305 H H y alternate 67.26310 Nochta11MS12BFIS800-168 H H y alternate 111.63691 OH1_176 N I n no.bevel 83.95530 ReedVoss2 H H y alternate 120.36607 TR10_4 N I n no.bevel 73.36491 Welton1 N P n no.bevel 222.31528 Welton2 N P y alternate 134.84432 Welton5 N P y unifacial.bimarginal 188.68723 # attributes for boxplots csz &lt;- qdata$csz # centroid size heart &lt;- qdata$heart.out # heartland in/out hreg &lt;- qdata$heart.reg # heartland region bev.1 &lt;- qdata$bev # beveled yes/no bev.2 &lt;- qdata$bev.type # type of beveling 4.3 Principal Components Analysis Principal components analysis (Jolliffe 2002) was used to visualise shape variation among the bifaces. The shape changes described by each principal axis are commonly visualized using thin-plate spline warping of a reference 3D mesh (Klingenberg 2013; Sherratt et al. 2014). # principal components analysis pca&lt;-gm.prcomp(Y.gpa$coords) summary(pca) ## ## Ordination type: Principal Component Analysis ## Centering and projection: OLS ## Number of observations 41 ## Number of vectors 41 ## ## Importance of Components: ## Comp1 Comp2 Comp3 Comp4 ## Eigenvalues 0.01309236 0.002948616 0.001079526 0.0006593874 ## Proportion of Variance 0.66840498 0.150535911 0.055113110 0.0336637492 ## Cumulative Proportion 0.66840498 0.818940893 0.874054002 0.9077177516 ## Comp5 Comp6 Comp7 Comp8 ## Eigenvalues 0.0003079612 0.0002871892 0.0001873739 0.000177321 ## Proportion of Variance 0.0157223637 0.0146618897 0.0095660117 0.009052782 ## Cumulative Proportion 0.9234401153 0.9381020050 0.9476680167 0.956720799 ## Comp9 Comp10 Comp11 Comp12 ## Eigenvalues 0.0001328815 0.0000903513 8.423705e-05 6.998802e-05 ## Proportion of Variance 0.0067840091 0.0046127110 4.300560e-03 3.573103e-03 ## Cumulative Proportion 0.9635048079 0.9681175188 9.724181e-01 9.759912e-01 ## Comp13 Comp14 Comp15 Comp16 ## Eigenvalues 6.116251e-05 0.0000583672 0.0000477215 4.434491e-05 ## Proportion of Variance 3.122533e-03 0.0029798243 0.0024363289 2.263944e-03 ## Cumulative Proportion 9.791137e-01 0.9820935393 0.9845298681 9.867938e-01 ## Comp17 Comp18 Comp19 Comp20 ## Eigenvalues 3.225885e-05 3.031609e-05 2.596142e-05 2.238225e-05 ## Proportion of Variance 1.646913e-03 1.547729e-03 1.325410e-03 1.142683e-03 ## Cumulative Proportion 9.884407e-01 9.899885e-01 9.913139e-01 9.924565e-01 ## Comp21 Comp22 Comp23 Comp24 ## Eigenvalues 2.107502e-05 1.926094e-05 1.382093e-05 1.307978e-05 ## Proportion of Variance 1.075944e-03 9.833302e-04 7.056009e-04 6.677630e-04 ## Cumulative Proportion 9.935325e-01 9.945158e-01 9.952214e-01 9.958892e-01 ## Comp25 Comp26 Comp27 Comp28 ## Eigenvalues 1.202387e-05 1.108433e-05 1.006566e-05 8.956883e-06 ## Proportion of Variance 6.138554e-04 5.658888e-04 5.138826e-04 4.572763e-04 ## Cumulative Proportion 9.965030e-01 9.970689e-01 9.975828e-01 9.980401e-01 ## Comp29 Comp30 Comp31 Comp32 ## Eigenvalues 7.430666e-06 6.103555e-06 5.294946e-06 3.855350e-06 ## Proportion of Variance 3.793583e-04 3.116052e-04 2.703232e-04 1.968275e-04 ## Cumulative Proportion 9.984194e-01 9.987311e-01 9.990014e-01 9.991982e-01 ## Comp33 Comp34 Comp35 Comp36 ## Eigenvalues 3.709280e-06 0.0000033365 2.478276e-06 2.107250e-06 ## Proportion of Variance 1.893701e-04 0.0001703385 1.265236e-04 1.075816e-04 ## Cumulative Proportion 9.993876e-01 0.9995579113 9.996844e-01 9.997920e-01 ## Comp37 Comp38 Comp39 Comp40 ## Eigenvalues 1.611993e-06 1.077719e-06 8.498190e-07 5.343375e-07 ## Proportion of Variance 8.229720e-05 5.502087e-05 4.338587e-05 2.727957e-05 ## Cumulative Proportion 9.998743e-01 9.999293e-01 9.999727e-01 1.000000e+00 ## Comp41 ## Eigenvalues 2.582012e-33 ## Proportion of Variance 1.318196e-31 ## Cumulative Proportion 1.000000e+00 4.4 Define models 4.4.1 Allometry # general allometry fit.size &lt;- procD.lm(shape ~ size, data = gdf, print.progress = FALSE, iter = 9999) 4.4.2 Hypothesis 1 ## Define models # allometry - common allometry, different means -&gt; heart fit.sz.cheart &lt;- procD.lm(shape ~ size + heart, data = gdf, print.progress = FALSE, iter = 9999) # allometry - unique allometries -&gt; heart fit.sz.uheart &lt;- procD.lm(shape ~ size * heart, data = gdf, print.progress = FALSE, iter = 9999) # size as a function of heart fit.size.heart &lt;- procD.lm(size ~ heart, data = gdf, print.progress = FALSE, iter = 9999) # shape as a function of heart fit.shape.heart &lt;- procD.lm(shape ~ heart, data = gdf, print.progress = FALSE, iter = 9999) 4.4.3 Hypothesis 2 ## Define models # allometry - common allometry, different means -&gt; hreg fit.sz.chreg &lt;- procD.lm(shape ~ size + hreg, data = gdf, print.progress = FALSE, iter = 9999) # allometry - unique allometries -&gt; hreg fit.sz.uhreg &lt;- procD.lm(shape ~ size * hreg, data = gdf, print.progress = FALSE, iter = 9999) # size as a function of hreg fit.size.hreg &lt;- procD.lm(size ~ hreg, data = gdf, print.progress = FALSE, iter = 9999) # shape as a function of hreg fit.shape.hreg &lt;- procD.lm(shape ~ hreg, data = gdf, print.progress = FALSE, iter = 9999) 4.4.4 Hypothesis 3 ## Define models # allometry - common allometry, different means -&gt; bev.1 fit.sz.cbev.1 &lt;- procD.lm(shape ~ size + bev.1, data = gdf, print.progress = FALSE, iter = 9999) # allometry - unique allometries -&gt; bev.1 fit.sz.ubev.1 &lt;- procD.lm(shape ~ size * bev.1, data = gdf, print.progress = FALSE, iter = 9999) # size as a function of bev.1 fit.size.bev.1 &lt;- procD.lm(size ~ bev.1, data = gdf, print.progress = FALSE, iter = 9999) # shape as a function of bev.1 fit.shape.bev.1 &lt;- procD.lm(shape ~ bev.1, data = gdf, print.progress = FALSE, iter = 9999) 4.4.5 Hypothesis 4 ## Define models # allometry - common allometry, different means -&gt; bev.2 fit.sz.cbev.2 &lt;- procD.lm(shape ~ size + bev.2, data = gdf, print.progress = FALSE, iter = 9999) # allometry - unique allometries -&gt; bev.2 fit.sz.ubev.2 &lt;- procD.lm(shape ~ size * bev.2, data = gdf, print.progress = FALSE, iter = 9999) # size as a function of bev.2 fit.size.bev.2 &lt;- procD.lm(size ~ bev.2, data = gdf, print.progress = FALSE, iter = 9999) # shape as a function of bev.2 fit.shape.bev.2 &lt;- procD.lm(shape ~ bev.2, data = gdf, print.progress = FALSE, iter = 9999) 4.5 Allometry # general allometry - does dalton shape change with size? anova(fit.size) ## ## Analysis of Variance, using Residual Randomization ## Permutation procedure: Randomization of null model residuals ## Number of permutations: 10000 ## Estimation method: Ordinary Least Squares ## Sums of Squares and Cross-products: Type I ## Effect sizes (Z) based on F distributions ## ## Df SS MS Rsq F Z Pr(&gt;F) ## size 1 0.32804 0.32804 0.41869 28.09 4.3261 1e-04 *** ## Residuals 39 0.45545 0.01168 0.58131 ## Total 40 0.78350 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Call: procD.lm(f1 = shape ~ size, iter = 9999, data = gdf, print.progress = FALSE) 4.6 Test Hypothesis 1 (Geo GM) Hypothesis 1 assesses whether there is a difference in morphology for Dalton points found in and out of the heartland. A residual randomization permutation procedure (RRPP; n = 10,000 permutations) was used for all Procrustes ANOVAs (Adams and Collyer 2015; Collyer and Adams 2018), which has higher statistical power and a greater ability to identify patterns in the data should they be present (Anderson and Ter Braak 2003). To assess whether shape changes with size (allometry), and differs by group (region), Procrustes ANOVAs (Goodall 1991) were also run that enlist effect-sizes (zscores) computed as standard deviates of the generated sampling distributions (Collyer, Sekora, and Adams 2015). knitr::include_graphics(&#39;images/dalton-vizhypothesis1.jpg&#39;) (#fig:lm3d3.a1.h1)Hypothesis 1 considers whether Dalton points discovered in (left) and out (right) of the Heartland differ in morphology. 4.6.1 Boxplot (H1) # boxplot of Dalton point centroid size by in/out heartland csz.hrt &lt;- ggplot(qdata, aes(x = heart, y = csz, color = heart)) + geom_boxplot() + geom_dotplot(binaxis = &#39;y&#39;, stackdir = &#39;center&#39;, dotsize = 0.3) + scale_colour_manual(values = wes_palette(&quot;Moonrise2&quot;)) + theme(legend.position = &quot;none&quot;) + labs(x = &#39;In Heartland?&#39;, y = &#39;Centroid Size&#39;) # render plot csz.hrt ## `stat_bindot()` using `bins = 30`. Pick better value with `binwidth`. Figure 4.2: Boxplot of centroid size by Heartland (in/out). 4.6.2 Principal Components Analysis (H1) # set plot parameters to plot by heartland in (H) and out (N) pch.gps.heart &lt;- c(15,17)[as.factor(heart)] col.gps.heart &lt;- wes_palette(&quot;Moonrise2&quot;)[as.factor(heart)] col.hull &lt;- c(&quot;#798E87&quot;,&quot;#C27D38&quot;) # plot pca by heartland in (H) and out (N) pc.plot1 &lt;- plot(pca, asp = 1, pch = pch.gps.heart, col = col.gps.heart) shapeHulls(pc.plot1, groups = heart, group.cols = col.hull) # mshape M &lt;- mshape(Y.gpa$coords) # shapes at the minima and maxima of PC1 and PC2 using min and max # corresponding to the x/y values in the four PC plots pc &lt;- pca$x[,1] # x-axis preds &lt;- shape.predictor(Y.gpa$coords, x = pc, Intercept = FALSE, pred1 = min(pc), pred2 = max(pc)) plotRefToTarget(M, preds$pred1) # minimum x-axis plotRefToTarget(M, preds$pred2) # maximum x-axis pc &lt;- pca$x[,2] # y-axis preds&lt;-shape.predictor(Y.gpa$coords, x = pc, Intercept = FALSE, pred1 = min(pc), pred2 = max(pc)) plotRefToTarget(M, preds$pred1) # minimum y-axis plotRefToTarget(M, preds$pred2) # maximum y-axis 4.6.3 ANOVA (H1) # heart anova(fit.sz.cheart) # common allometry (heart) ## ## Analysis of Variance, using Residual Randomization ## Permutation procedure: Randomization of null model residuals ## Number of permutations: 10000 ## Estimation method: Ordinary Least Squares ## Sums of Squares and Cross-products: Type I ## Effect sizes (Z) based on F distributions ## ## Df SS MS Rsq F Z Pr(&gt;F) ## size 1 0.32804 0.32804 0.41869 32.2999 4.4882 1e-04 *** ## heart 1 0.06952 0.06952 0.08873 6.8449 3.1809 6e-04 *** ## Residuals 38 0.38594 0.01016 0.49258 ## Total 40 0.78350 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Call: procD.lm(f1 = shape ~ size + heart, iter = 9999, data = gdf, ## print.progress = FALSE) # heart anova(fit.sz.uheart) # unique allometry (heart) ## ## Analysis of Variance, using Residual Randomization ## Permutation procedure: Randomization of null model residuals ## Number of permutations: 10000 ## Estimation method: Ordinary Least Squares ## Sums of Squares and Cross-products: Type I ## Effect sizes (Z) based on F distributions ## ## Df SS MS Rsq F Z Pr(&gt;F) ## size 1 0.32804 0.32804 0.41869 33.5287 4.5301 1e-04 *** ## heart 1 0.06952 0.06952 0.08873 7.1053 3.2353 0.0005 *** ## size:heart 1 0.02393 0.02393 0.03054 2.4457 1.6437 0.0551 . ## Residuals 37 0.36201 0.00978 0.46204 ## Total 40 0.78350 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Call: procD.lm(f1 = shape ~ size * heart, iter = 9999, data = gdf, ## print.progress = FALSE) # ANOVA: do dalton projectile point sizes differ by heart? anova(fit.size.heart) ## ## Analysis of Variance, using Residual Randomization ## Permutation procedure: Randomization of null model residuals ## Number of permutations: 10000 ## Estimation method: Ordinary Least Squares ## Sums of Squares and Cross-products: Type I ## Effect sizes (Z) based on F distributions ## ## Df SS MS Rsq F Z Pr(&gt;F) ## heart 1 2491 2490.7 0.05567 2.299 0.92469 0.1371 ## Residuals 39 42253 1083.4 0.94433 ## Total 40 44743 ## ## Call: procD.lm(f1 = size ~ heart, iter = 9999, data = gdf, print.progress = FALSE) # ANOVA: do dalton projectile point shapes differ by heart? anova(fit.shape.heart) ## ## Analysis of Variance, using Residual Randomization ## Permutation procedure: Randomization of null model residuals ## Number of permutations: 10000 ## Estimation method: Ordinary Least Squares ## Sums of Squares and Cross-products: Type I ## Effect sizes (Z) based on F distributions ## ## Df SS MS Rsq F Z Pr(&gt;F) ## heart 1 0.12924 0.129241 0.16495 7.704 2.817 0.001 ** ## Residuals 39 0.65426 0.016776 0.83505 ## Total 40 0.78350 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Call: procD.lm(f1 = shape ~ heart, iter = 9999, data = gdf, print.progress = FALSE) 4.6.4 Allometry (H1) # regscore (Drake and Klingenberg 2008) # heart plotAllometry(fit.sz.cheart, size = gdf$size, logsz = TRUE, method = &quot;RegScore&quot;, pch = pch.gps.heart, col = col.gps.heart) # common allometric component (Mitteroecker 2004) # heart plotAllometry(fit.sz.cheart, size = gdf$size, logsz = TRUE, method = &quot;CAC&quot;, pch = pch.gps.heart, col = col.gps.heart) # size-shape pca (Mitteroecker 2004) # heart plotAllometry(fit.sz.cheart, size = gdf$size, logsz = TRUE, method = &quot;size.shape&quot;, pch = pch.gps.heart, col = col.gps.heart) ## predline (Adams and Nistri 2010) # heart plotAllometry(fit.sz.uheart, size = gdf$size, logsz = TRUE, method = &quot;PredLine&quot;, pch = pch.gps.heart, col = col.gps.heart) 4.6.5 Morphological disparity (H1) # morphological disparity: does one group display greater # shape variation among individuals relative to the other group? morphol.disparity(shape ~ heart, groups = qdata$heart.out, data = gdf, print.progress = FALSE, iter = 9999) ## ## Call: ## morphol.disparity(f1 = shape ~ heart, groups = qdata$heart.out, ## iter = 9999, data = gdf, print.progress = FALSE) ## ## ## ## Randomized Residual Permutation Procedure Used ## 10000 Permutations ## ## Procrustes variances for defined groups ## H N ## 0.01810433 0.01391291 ## ## ## Pairwise absolute differences between variances ## H N ## H 0.000000000 0.004191421 ## N 0.004191421 0.000000000 ## ## ## P-Values ## H N ## H 1.0000 0.6456 ## N 0.6456 1.0000 4.6.6 Mean Shapes (H1) # subset landmark coordinates to produce mean shapes for hypothesis 1 new.coords&lt;-coords.subset(A = Y.gpa$coords, group = qdata$heart.out) names(new.coords) ## [1] &quot;H&quot; &quot;N&quot; # group shape means mean &lt;- lapply(new.coords, mshape) # plot mean shapes plot(mean$H) plot(mean$N) # comparison plots plotRefToTarget(mean$H, mean$N, method=&quot;vector&quot;, mag=2) ##knitr::include_graphics(&#39;images/mshape.h1.jpg&#39;) 4.7 Test Hypothesis 2 (Geo GM) Hypothesis 2 assesses whether there is a difference in morphology for Dalton points found in the heartland, the interior, and the northern periphery. A residual randomization permutation procedure (RRPP; n = 10,000 permutations) was used for all Procrustes ANOVAs (Adams and Collyer 2015; Collyer and Adams 2018), which has higher statistical power and a greater ability to identify patterns in the data should they be present (Anderson and Ter Braak 2003). To assess whether shape changes with size (allometry), and differs by group (region), Procrustes ANOVAs (Goodall 1991) were also run that enlist effect-sizes (zscores) computed as standard deviates of the generated sampling distributions (Collyer, Sekora, and Adams 2015). knitr::include_graphics(&#39;images/dalton-vizhypothesis2.jpg&#39;) (#fig:lm3d3.a1.h2)Hypothesis 2 considers whether Dalton points discovered in the heartland (left), interior (center), and northern periphery (right) differ in morphology. 4.7.1 Boxplot (H2) # boxplot of Dalton point centroid size by heartland + regions csz.hreg &lt;- ggplot(qdata, aes(x = hreg, y = csz, color = hreg)) + geom_boxplot() + geom_dotplot(binaxis = &#39;y&#39;, stackdir = &#39;center&#39;, dotsize = 0.3) + scale_colour_manual(values = wes_palette(&quot;Moonrise2&quot;)) + theme(legend.position = &quot;none&quot;) + labs(x = &#39;Heartland Region&#39;, y = &#39;Centroid Size&#39;) # render plot csz.hreg ## `stat_bindot()` using `bins = 30`. Pick better value with `binwidth`. Figure 4.3: Boxplot of centroid size by Heartland region. 4.7.2 Principal Components Analysis (H2) # set plot parameters to plot by heartland + regions pch.gps.hreg &lt;- c(15,17,18)[as.factor(hreg)] col.gps.hreg &lt;- wes_palette(&quot;Moonrise2&quot;)[as.factor(hreg)] col.hull.2 &lt;- c(&quot;#798E87&quot;,&quot;#CCC591&quot;,&quot;#C27D38&quot;) # plot pca by heartland + regions pc.plot2 &lt;- plot(pca, asp = 1, pch = pch.gps.hreg, col = col.gps.hreg) shapeHulls(pc.plot2, groups = hreg, group.cols = col.hull.2) 4.7.3 ANOVA (H2) # hreg anova(fit.sz.chreg) # common allometry (hreg) ## ## Analysis of Variance, using Residual Randomization ## Permutation procedure: Randomization of null model residuals ## Number of permutations: 10000 ## Estimation method: Ordinary Least Squares ## Sums of Squares and Cross-products: Type I ## Effect sizes (Z) based on F distributions ## ## Df SS MS Rsq F Z Pr(&gt;F) ## size 1 0.32804 0.32804 0.41869 32.1375 4.4789 1e-04 *** ## hreg 2 0.07778 0.03889 0.09927 3.8097 2.8898 0.0012 ** ## Residuals 37 0.37768 0.01021 0.48204 ## Total 40 0.78350 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Call: procD.lm(f1 = shape ~ size + hreg, iter = 9999, data = gdf, print.progress = FALSE) # hreg anova(fit.sz.uhreg) # unique allometry (hreg) ## ## Analysis of Variance, using Residual Randomization ## Permutation procedure: Randomization of null model residuals ## Number of permutations: 10000 ## Estimation method: Ordinary Least Squares ## Sums of Squares and Cross-products: Type I ## Effect sizes (Z) based on F distributions ## ## Df SS MS Rsq F Z Pr(&gt;F) ## size 1 0.32804 0.32804 0.41869 33.7298 4.5329 1e-04 *** ## hreg 2 0.07778 0.03889 0.09927 3.9985 2.9809 0.0008 *** ## size:hreg 2 0.03728 0.01864 0.04758 1.9166 1.5007 0.0684 . ## Residuals 35 0.34040 0.00973 0.43446 ## Total 40 0.78350 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Call: procD.lm(f1 = shape ~ size * hreg, iter = 9999, data = gdf, print.progress = FALSE) # ANOVA: does dalton projectile point size differ by hreg? anova(fit.size.hreg) ## ## Analysis of Variance, using Residual Randomization ## Permutation procedure: Randomization of null model residuals ## Number of permutations: 10000 ## Estimation method: Ordinary Least Squares ## Sums of Squares and Cross-products: Type I ## Effect sizes (Z) based on F distributions ## ## Df SS MS Rsq F Z Pr(&gt;F) ## hreg 2 8967 4483.3 0.2004 4.7619 1.6017 0.0142 * ## Residuals 38 35777 941.5 0.7996 ## Total 40 44743 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Call: procD.lm(f1 = size ~ hreg, iter = 9999, data = gdf, print.progress = FALSE) # pairwise comparison of LS means = which differ? sz.hreg &lt;- pairwise(fit.size.hreg, groups = qdata$heart.reg) summary(sz.hreg, confidence = 0.95, test.type = &quot;dist&quot;) ## ## Pairwise comparisons ## ## Groups: H I P ## ## RRPP: 10000 permutations ## ## LS means: ## Vectors hidden (use show.vectors = TRUE to view) ## ## Pairwise distances between means, plus statistics ## d UCL (95%) Z Pr &gt; d ## H:I 28.010203 22.64950 2.7102945 0.0114 ## H:P 9.241509 29.00339 -0.3212633 0.5548 ## I:P 37.251712 30.60554 2.6462055 0.0134 # pairwise distance between variances = standardization? summary(sz.hreg, confidence = 0.95, test.type = &quot;var&quot;) ## ## Pairwise comparisons ## ## Groups: H I P ## ## RRPP: 10000 permutations ## ## ## Observed variances by group ## ## H I P ## 765.6253 242.0404 2439.3694 ## ## Pairwise distances between variances, plus statistics ## d UCL (95%) Z Pr &gt; d ## H:I 523.5849 987.3217 0.2811609 0.3623 ## H:P 1673.7440 1265.1701 2.8979769 0.0137 ## I:P 2197.3290 1350.3031 3.9315467 0.0010 # ANOVA: does dalton projectile point shape differ by hreg? anova(fit.shape.hreg) ## ## Analysis of Variance, using Residual Randomization ## Permutation procedure: Randomization of null model residuals ## Number of permutations: 10000 ## Estimation method: Ordinary Least Squares ## Sums of Squares and Cross-products: Type I ## Effect sizes (Z) based on F distributions ## ## Df SS MS Rsq F Z Pr(&gt;F) ## hreg 2 0.1566 0.078299 0.19987 4.7462 2.674 0.0021 ** ## Residuals 38 0.6269 0.016497 0.80013 ## Total 40 0.7835 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Call: procD.lm(f1 = shape ~ hreg, iter = 9999, data = gdf, print.progress = FALSE) # pairwise comparison of LS means = which differ? sh.hreg &lt;- pairwise(fit.shape.hreg, groups = qdata$heart.reg) summary(sz.hreg, confidence = 0.95, test.type = &quot;dist&quot;) ## ## Pairwise comparisons ## ## Groups: H I P ## ## RRPP: 10000 permutations ## ## LS means: ## Vectors hidden (use show.vectors = TRUE to view) ## ## Pairwise distances between means, plus statistics ## d UCL (95%) Z Pr &gt; d ## H:I 28.010203 22.64950 2.7102945 0.0114 ## H:P 9.241509 29.00339 -0.3212633 0.5548 ## I:P 37.251712 30.60554 2.6462055 0.0134 # pairwise distance between variances = standardization? summary(sz.hreg, confidence = 0.95, test.type = &quot;var&quot;) ## ## Pairwise comparisons ## ## Groups: H I P ## ## RRPP: 10000 permutations ## ## ## Observed variances by group ## ## H I P ## 765.6253 242.0404 2439.3694 ## ## Pairwise distances between variances, plus statistics ## d UCL (95%) Z Pr &gt; d ## H:I 523.5849 987.3217 0.2811609 0.3623 ## H:P 1673.7440 1265.1701 2.8979769 0.0137 ## I:P 2197.3290 1350.3031 3.9315467 0.0010 4.7.4 Allometry (H2) # regscore (Drake and Klingenberg 2008) # hreg plotAllometry(fit.sz.chreg, size = gdf$size, logsz = TRUE, method = &quot;RegScore&quot;, pch = pch.gps.hreg, col = col.gps.hreg) # common allometric component (Mitteroecker 2004) # hreg plotAllometry(fit.sz.chreg, size = gdf$size, logsz = TRUE, method = &quot;CAC&quot;, pch = pch.gps.hreg, col = col.gps.hreg) # size-shape pca (Mitteroecker 2004) # hreg plotAllometry(fit.sz.chreg, size = gdf$size, logsz = TRUE, method = &quot;size.shape&quot;, pch = pch.gps.hreg, col = col.gps.hreg) # predline (Adams and Nistri 2010) # hreg plotAllometry(fit.sz.uhreg, size = gdf$size, logsz = TRUE, method = &quot;PredLine&quot;, pch = pch.gps.hreg, col = col.gps.hreg) 4.7.5 Morphological disparity (H2) # morphological disparity: do any of the groups display greater # shape variation among individuals relative to the other group? morphol.disparity(shape ~ hreg, groups = qdata$heart.reg, data = gdf, print.progress = FALSE, iter = 9999) ## ## Call: ## morphol.disparity(f1 = shape ~ hreg, groups = qdata$heart.reg, ## iter = 9999, data = gdf, print.progress = FALSE) ## ## ## ## Randomized Residual Permutation Procedure Used ## 10000 Permutations ## ## Procrustes variances for defined groups ## H I P ## 0.01810433 0.01120108 0.01542829 ## ## ## Pairwise absolute differences between variances ## H I P ## H 0.000000000 0.006903248 0.002676041 ## I 0.006903248 0.000000000 0.004227207 ## P 0.002676041 0.004227207 0.000000000 ## ## ## P-Values ## H I P ## H 1.000 0.4250 0.7700 ## I 0.425 1.0000 0.6493 ## P 0.770 0.6493 1.0000 4.7.6 Mean Shapes (H2) # subset landmark coordinates to produce mean shapes for hypothesis 2 new.coords&lt;-coords.subset(A = Y.gpa$coords, group = qdata$heart.reg) names(new.coords) ## [1] &quot;H&quot; &quot;I&quot; &quot;P&quot; # group shape means mean &lt;- lapply(new.coords, mshape) # plot mean shapes plot(mean$H) plot(mean$I) plot(mean$P) # comparison plots plotRefToTarget(mean$H, mean$I, method=&quot;vector&quot;, mag=2) plotRefToTarget(mean$H, mean$P, method=&quot;vector&quot;, mag=2) plotRefToTarget(mean$I, mean$P, method=&quot;vector&quot;, mag=2) ##knitr::include_graphics(&#39;images/mshape.h2.jpg&#39;) 4.8 Test Hypothesis 3 (Techno GM) Hypothesis 3 assesses whether there is a discernible difference in morphology for Dalton points that are beveled. A residual randomization permutation procedure (RRPP; n = 10,000 permutations) was used for all Procrustes ANOVAs (Adams and Collyer 2015; Collyer and Adams 2018), which has higher statistical power and a greater ability to identify patterns in the data should they be present (Anderson and Ter Braak 2003). To assess whether shape changes with size (allometry), and differs by group (region), Procrustes ANOVAs (Goodall 1991) were also run that enlist effect-sizes (zscores) computed as standard deviates of the generated sampling distributions (Collyer, Sekora, and Adams 2015). knitr::include_graphics(&#39;images/dalton-vizhypothesis3.jpg&#39;) (#fig:lm3d3.a1.h3)Hypothesis 3 considers whether beveled Dalton points (left) differ in morphology from those that are not beveled (right). 4.8.1 Boxplot (H3) # boxplot of Dalton point centroid size by beveled y/n csz.bev.1 &lt;- ggplot(qdata, aes(x = bev.1, y = csz, color = bev.1)) + geom_boxplot() + geom_dotplot(binaxis = &#39;y&#39;, stackdir = &#39;center&#39;, dotsize = 0.3) + scale_colour_manual(values = wes_palette(&quot;Moonrise2&quot;)) + theme(legend.position = &quot;none&quot;) + labs(x = &#39;Beveled?&#39;, y = &#39;Centroid Size&#39;) # render plot csz.bev.1 ## `stat_bindot()` using `bins = 30`. Pick better value with `binwidth`. Figure 4.4: Boxplot of centroid size by beveled. 4.8.2 Principal Components Analysis (H3) # set plot parameters to plot by beveled y and n pch.gps.bev.1 &lt;- c(15,17)[as.factor(bev.1)] col.gps.bev.1 &lt;- wes_palette(&quot;Moonrise2&quot;)[as.factor(bev.1)] col.hull.3 &lt;- c(&quot;#C27D38&quot;,&quot;#798E87&quot;) # plot pca by heartland in (H) and out (N) pc.plot3 &lt;- plot(pca, asp = 1, pch = pch.gps.bev.1, col = col.gps.bev.1) shapeHulls(pc.plot3, groups = bev.1, group.cols = col.hull.3) 4.8.3 ANOVA (H3) # bev.1 anova(fit.sz.cbev.1) # common allometry (bev.1) ## ## Analysis of Variance, using Residual Randomization ## Permutation procedure: Randomization of null model residuals ## Number of permutations: 10000 ## Estimation method: Ordinary Least Squares ## Sums of Squares and Cross-products: Type I ## Effect sizes (Z) based on F distributions ## ## Df SS MS Rsq F Z Pr(&gt;F) ## size 1 0.32804 0.32804 0.41869 31.2092 4.4484 1e-04 *** ## bev.1 1 0.05603 0.05603 0.07151 5.3306 2.7960 0.0013 ** ## Residuals 38 0.39942 0.01051 0.50980 ## Total 40 0.78350 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Call: procD.lm(f1 = shape ~ size + bev.1, iter = 9999, data = gdf, ## print.progress = FALSE) # bev.1 anova(fit.sz.ubev.1) # unique allometry (bev.1) ## ## Analysis of Variance, using Residual Randomization ## Permutation procedure: Randomization of null model residuals ## Number of permutations: 10000 ## Estimation method: Ordinary Least Squares ## Sums of Squares and Cross-products: Type I ## Effect sizes (Z) based on F distributions ## ## Df SS MS Rsq F Z Pr(&gt;F) ## size 1 0.32804 0.32804 0.41869 31.5885 4.4606 1e-04 *** ## bev.1 1 0.05603 0.05603 0.07151 5.3953 2.8117 0.0012 ** ## size:bev.1 1 0.01518 0.01518 0.01938 1.4619 0.8753 0.1931 ## Residuals 37 0.38424 0.01038 0.49042 ## Total 40 0.78350 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Call: procD.lm(f1 = shape ~ size * bev.1, iter = 9999, data = gdf, ## print.progress = FALSE) # ANOVA: do dalton projectile point sizes differ by beveling? anova(fit.size.bev.1) ## ## Analysis of Variance, using Residual Randomization ## Permutation procedure: Randomization of null model residuals ## Number of permutations: 10000 ## Estimation method: Ordinary Least Squares ## Sums of Squares and Cross-products: Type I ## Effect sizes (Z) based on F distributions ## ## Df SS MS Rsq F Z Pr(&gt;F) ## bev.1 1 2333 2333.4 0.05215 2.1458 0.89979 0.1565 ## Residuals 39 42410 1087.4 0.94785 ## Total 40 44743 ## ## Call: procD.lm(f1 = size ~ bev.1, iter = 9999, data = gdf, print.progress = FALSE) # ANOVA: do dalton projectile point shapes differ by beveling? anova(fit.shape.bev.1) ## ## Analysis of Variance, using Residual Randomization ## Permutation procedure: Randomization of null model residuals ## Number of permutations: 10000 ## Estimation method: Ordinary Least Squares ## Sums of Squares and Cross-products: Type I ## Effect sizes (Z) based on F distributions ## ## Df SS MS Rsq F Z Pr(&gt;F) ## bev.1 1 0.10992 0.109916 0.14029 6.3641 2.5947 0.0038 ** ## Residuals 39 0.67358 0.017271 0.85971 ## Total 40 0.78350 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Call: procD.lm(f1 = shape ~ bev.1, iter = 9999, data = gdf, print.progress = FALSE) 4.8.4 Allometry (H3) # regscore (Drake and Klingenberg 2008) # bev.1 plotAllometry(fit.sz.cbev.1, size = gdf$size, logsz = TRUE, method = &quot;RegScore&quot;, pch = pch.gps.bev.1, col = col.gps.bev.1) # common allometric component (Mitteroecker 2004) # bev.1 plotAllometry(fit.sz.cbev.1, size = gdf$size, logsz = TRUE, method = &quot;CAC&quot;, pch = pch.gps.bev.1, col = col.gps.bev.1) # size-shape pca (Mitteroecker 2004) # bev.1 plotAllometry(fit.sz.cbev.1, size = gdf$size, logsz = TRUE, method = &quot;size.shape&quot;, pch = pch.gps.bev.1, col = col.gps.bev.1) # predline (Adams and Nistri 2010) # bev.1 plotAllometry(fit.sz.ubev.1, size = gdf$size, logsz = TRUE, method = &quot;PredLine&quot;, pch = pch.gps.bev.1, col = col.gps.bev.1) 4.8.5 Morphological disparity (H3) # morphological disparity: does one group display greater # shape variation among individuals relative to the other group? morphol.disparity(shape ~ bev.1, groups = qdata$bev, data = gdf, print.progress = FALSE, iter = 9999) ## ## Call: ## morphol.disparity(f1 = shape ~ bev.1, groups = qdata$bev, iter = 9999, ## data = gdf, print.progress = FALSE) ## ## ## ## Randomized Residual Permutation Procedure Used ## 10000 Permutations ## ## Procrustes variances for defined groups ## n y ## 0.01266879 0.01883527 ## ## ## Pairwise absolute differences between variances ## n y ## n 0.000000000 0.006166472 ## y 0.006166472 0.000000000 ## ## ## P-Values ## n y ## n 1.0000 0.4167 ## y 0.4167 1.0000 4.8.6 Mean Shapes (H3) # subset landmark coordinates to produce mean shapes for hypothesis 3 new.coords&lt;-coords.subset(A = Y.gpa$coords, group = qdata$bev) names(new.coords) ## [1] &quot;n&quot; &quot;y&quot; # group shape means mean &lt;- lapply(new.coords, mshape) # plot mean shapes plot(mean$y) plot(mean$n) # comparison plots plotRefToTarget(mean$y, mean$n, method=&quot;vector&quot;, mag=2) ##knitr::include_graphics(&#39;images/mshape.h3.jpg&#39;) 4.9 Test Hypothesis 4 (Techno GM) Hypothesis 4 assesses whether there is a discernible difference in the morphology of specific beveling types associated with Dalton points. A residual randomization permutation procedure (RRPP; n = 10,000 permutations) was used for all Procrustes ANOVAs (Adams and Collyer 2015; Collyer and Adams 2018), which has higher statistical power and a greater ability to identify patterns in the data should they be present (Anderson and Ter Braak 2003). To assess whether shape changes with size (allometry), and differs by group (region), Procrustes ANOVAs (Goodall 1991) were also run that enlist effect-sizes (zscores) computed as standard deviates of the generated sampling distributions (Collyer, Sekora, and Adams 2015). knitr::include_graphics(&#39;images/dalton-vizhypothesis4-1.jpg&#39;) (#fig:lm3d3.a1.h4)Hypothesis 4 considers whether discrete beveling practices articulate with differences in the morphology of Dalton points 4.9.1 Boxplot (H4) # boxplot of Dalton point centroid size by bevel type csz.bev.2 &lt;- ggplot(qdata, aes(x = bev.2, y = csz, color = bev.2)) + geom_boxplot() + geom_dotplot(binaxis = &#39;y&#39;, stackdir = &#39;center&#39;, dotsize = 0.3) + scale_colour_manual(values = wes_palette(&quot;Moonrise2&quot;)) + theme(legend.position = &quot;none&quot;) + labs(x = &#39;Bevel Type&#39;, y = &#39;Centroid Size&#39;) # render plot csz.bev.2 ## `stat_bindot()` using `bins = 30`. Pick better value with `binwidth`. Figure 4.5: Boxplot of centroid size by bevel type. 4.9.2 Principal Components Analysis (H4) # set plot parameters to plot by bevel type pch.gps.bev.2 &lt;- c(15,17,18)[as.factor(bev.2)] col.gps.bev.2 &lt;- wes_palette(&quot;Moonrise2&quot;)[as.factor(bev.2)] col.hull.4 &lt;- c(&quot;#CCC591&quot;,&quot;#C27D38&quot;,&quot;#798E87&quot;) # plot pca by bevel type pc.plot4 &lt;- plot(pca, asp = 1, pch = pch.gps.bev.2, col = col.gps.bev.2) shapeHulls(pc.plot4, groups = bev.2, group.cols = col.hull.4) 4.9.3 ANOVA (H4) # bev.2 anova(fit.sz.cbev.2) # common allometry (bev.2) ## ## Analysis of Variance, using Residual Randomization ## Permutation procedure: Randomization of null model residuals ## Number of permutations: 10000 ## Estimation method: Ordinary Least Squares ## Sums of Squares and Cross-products: Type I ## Effect sizes (Z) based on F distributions ## ## Df SS MS Rsq F Z Pr(&gt;F) ## size 1 0.32804 0.32804 0.41869 34.5021 4.5651 1e-04 *** ## bev.2 2 0.10366 0.05183 0.13230 5.4512 3.5717 1e-04 *** ## Residuals 37 0.35179 0.00951 0.44900 ## Total 40 0.78350 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Call: procD.lm(f1 = shape ~ size + bev.2, iter = 9999, data = gdf, ## print.progress = FALSE) # bev.2 anova(fit.sz.ubev.2) # unique allometry (bev.2) ## ## Analysis of Variance, using Residual Randomization ## Permutation procedure: Randomization of null model residuals ## Number of permutations: 10000 ## Estimation method: Ordinary Least Squares ## Sums of Squares and Cross-products: Type I ## Effect sizes (Z) based on F distributions ## ## Df SS MS Rsq F Z Pr(&gt;F) ## size 1 0.32804 0.32804 0.41869 35.0681 4.5789 1e-04 *** ## bev.2 2 0.10366 0.05183 0.13230 5.5406 3.5967 1e-04 *** ## size:bev.2 2 0.02439 0.01219 0.03113 1.3035 0.7341 0.2274 ## Residuals 35 0.32741 0.00935 0.41788 ## Total 40 0.78350 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Call: procD.lm(f1 = shape ~ size * bev.2, iter = 9999, data = gdf, ## print.progress = FALSE) # ANOVA: does dalton projectile point size differ by bev.2? anova(fit.size.bev.2) ## ## Analysis of Variance, using Residual Randomization ## Permutation procedure: Randomization of null model residuals ## Number of permutations: 10000 ## Estimation method: Ordinary Least Squares ## Sums of Squares and Cross-products: Type I ## Effect sizes (Z) based on F distributions ## ## Df SS MS Rsq F Z Pr(&gt;F) ## bev.2 2 2829 1414.5 0.06323 1.2824 0.61261 0.2819 ## Residuals 38 41914 1103.0 0.93677 ## Total 40 44743 ## ## Call: procD.lm(f1 = size ~ bev.2, iter = 9999, data = gdf, print.progress = FALSE) # pairwise comparison of LS means = which differ? sz.bev.2 &lt;- pairwise(fit.size.bev.2, groups = qdata$bev.type) summary(sz.bev.2, confidence = 0.95, test.type = &quot;dist&quot;) ## ## Pairwise comparisons ## ## Groups: alternate no.bevel unifacial.bimarginal ## ## RRPP: 10000 permutations ## ## LS means: ## Vectors hidden (use show.vectors = TRUE to view) ## ## Pairwise distances between means, plus statistics ## d UCL (95%) Z Pr &gt; d ## alternate:no.bevel 13.82105 21.62410 0.7566772 0.2168 ## alternate:unifacial.bimarginal 13.70139 39.50807 -0.2235649 0.5161 ## no.bevel:unifacial.bimarginal 27.52245 40.69728 0.8325099 0.1867 # pairwise distance between variances = standardization? summary(sz.bev.2, confidence = 0.95, test.type = &quot;var&quot;) ## ## Pairwise comparisons ## ## Groups: alternate no.bevel unifacial.bimarginal ## ## RRPP: 10000 permutations ## ## ## Observed variances by group ## ## alternate no.bevel unifacial.bimarginal ## 864.8726 1156.3579 1461.7774 ## ## Pairwise distances between variances, plus statistics ## d UCL (95%) Z Pr &gt; d ## alternate:no.bevel 291.4854 1238.404 -1.0026019 0.8151 ## alternate:unifacial.bimarginal 596.9049 3844.126 -0.3087819 0.5443 ## no.bevel:unifacial.bimarginal 305.4195 3855.441 -0.6203602 0.7689 # ANOVA: does dalton projectile point shape differ by bev.2? anova(fit.shape.bev.2) ## ## Analysis of Variance, using Residual Randomization ## Permutation procedure: Randomization of null model residuals ## Number of permutations: 10000 ## Estimation method: Ordinary Least Squares ## Sums of Squares and Cross-products: Type I ## Effect sizes (Z) based on F distributions ## ## Df SS MS Rsq F Z Pr(&gt;F) ## bev.2 2 0.14512 0.072562 0.18523 4.3193 2.5323 0.0033 ** ## Residuals 38 0.63837 0.016799 0.81477 ## Total 40 0.78350 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Call: procD.lm(f1 = shape ~ bev.2, iter = 9999, data = gdf, print.progress = FALSE) # pairwise comparison of LS means = which differ? sh.bev.2 &lt;- pairwise(fit.shape.bev.2, groups = qdata$bev.type) summary(sz.bev.2, confidence = 0.95, test.type = &quot;dist&quot;) ## ## Pairwise comparisons ## ## Groups: alternate no.bevel unifacial.bimarginal ## ## RRPP: 10000 permutations ## ## LS means: ## Vectors hidden (use show.vectors = TRUE to view) ## ## Pairwise distances between means, plus statistics ## d UCL (95%) Z Pr &gt; d ## alternate:no.bevel 13.82105 21.62410 0.7566772 0.2168 ## alternate:unifacial.bimarginal 13.70139 39.50807 -0.2235649 0.5161 ## no.bevel:unifacial.bimarginal 27.52245 40.69728 0.8325099 0.1867 # pairwise distance between variances = standardization? summary(sz.bev.2, confidence = 0.95, test.type = &quot;var&quot;) ## ## Pairwise comparisons ## ## Groups: alternate no.bevel unifacial.bimarginal ## ## RRPP: 10000 permutations ## ## ## Observed variances by group ## ## alternate no.bevel unifacial.bimarginal ## 864.8726 1156.3579 1461.7774 ## ## Pairwise distances between variances, plus statistics ## d UCL (95%) Z Pr &gt; d ## alternate:no.bevel 291.4854 1238.404 -1.0026019 0.8151 ## alternate:unifacial.bimarginal 596.9049 3844.126 -0.3087819 0.5443 ## no.bevel:unifacial.bimarginal 305.4195 3855.441 -0.6203602 0.7689 4.9.4 Allometry (H4) # regscore (Drake and Klingenberg 2008) # bev.2 plotAllometry(fit.sz.cbev.2, size = gdf$size, logsz = TRUE, method = &quot;RegScore&quot;, pch = pch.gps.bev.2, col = col.gps.bev.2) # common allometric component (Mitteroecker 2004) # bev.2 plotAllometry(fit.sz.cbev.2, size = gdf$size, logsz = TRUE, method = &quot;CAC&quot;, pch = pch.gps.bev.2, col = col.gps.bev.2) # size-shape pca (Mitteroecker 2004) # bev.2 plotAllometry(fit.sz.cbev.2, size = gdf$size, logsz = TRUE, method = &quot;size.shape&quot;, pch = pch.gps.bev.2, col = col.gps.bev.2) # predline (Adams and Nistri 2010) # bev.2 plotAllometry(fit.sz.ubev.2, size = gdf$size, logsz = TRUE, method = &quot;PredLine&quot;, pch = pch.gps.bev.2, col = col.gps.bev.2) 4.9.5 Morphological disparity (H4) # morphological disparity: do any of the groups display greater # shape variation among individuals relative to the other group? morphol.disparity(shape ~ bev.2, groups = qdata$bev.type, data = gdf, print.progress = FALSE, iter = 9999) ## ## Call: ## morphol.disparity(f1 = shape ~ bev.2, groups = qdata$bev.type, ## iter = 9999, data = gdf, print.progress = FALSE) ## ## ## ## Randomized Residual Permutation Procedure Used ## 10000 Permutations ## ## Procrustes variances for defined groups ## alternate no.bevel unifacial.bimarginal ## 0.01758059 0.01266879 0.01630035 ## ## ## Pairwise absolute differences between variances ## alternate no.bevel unifacial.bimarginal ## alternate 0.000000000 0.004911794 0.001280240 ## no.bevel 0.004911794 0.000000000 0.003631554 ## unifacial.bimarginal 0.001280240 0.003631554 0.000000000 ## ## ## P-Values ## alternate no.bevel unifacial.bimarginal ## alternate 1.0000 0.5804 0.8982 ## no.bevel 0.5804 1.0000 0.7055 ## unifacial.bimarginal 0.8982 0.7055 1.0000 4.9.6 Mean Shapes (H4) # subset landmark coordinates to produce mean shapes for hypothesis 4 new.coords&lt;-coords.subset(A = Y.gpa$coords, group = qdata$bev.type) names(new.coords) ## [1] &quot;alternate&quot; &quot;no.bevel&quot; &quot;unifacial.bimarginal&quot; # group shape means mean &lt;- lapply(new.coords, mshape) # plot mean shapes plot(mean$alternate) plot(mean$no.bevel) plot(mean$unifacial.bimarginal) # comparison plots plotRefToTarget(mean$alternate, mean$no.bevel, method=&quot;vector&quot;, mag=2) plotRefToTarget(mean$alternate, mean$unifacial.bimarginal, method=&quot;vector&quot;, mag=2) plotRefToTarget(mean$no.bevel, mean$unifacial.bimarginal, method=&quot;vector&quot;, mag=2) ##knitr::include_graphics(&#39;images/mshape.h4.jpg&#39;) 4.10 Morphological integration # morphological integration:: # partition blade/base landmarks land.gps&lt;-c(&quot;A&quot;,&quot;B&quot;,&quot;B&quot;,&quot;B&quot;,&quot;B&quot;,&quot;B&quot;,&quot;A&quot;,&quot;A&quot;, &quot;A&quot;,&quot;A&quot;,&quot;B&quot;,&quot;B&quot;,&quot;B&quot;,&quot;B&quot;,&quot;A&quot;,&quot;A&quot;, &quot;A&quot;,&quot;A&quot;,&quot;A&quot;,&quot;A&quot;,&quot;A&quot;,&quot;A&quot;,&quot;B&quot;,&quot;B&quot;, &quot;B&quot;,&quot;B&quot;,&quot;A&quot;,&quot;A&quot;,&quot;A&quot;,&quot;A&quot;,&quot;B&quot;,&quot;B&quot;, &quot;B&quot;,&quot;B&quot;) it&lt;-integration.test(Y.gpa$coords, partition.gp = land.gps, iter = 9999, print.progress = FALSE) summary(it) ## ## Call: ## integration.test(A = Y.gpa$coords, partition.gp = land.gps, iter = 9999, ## print.progress = FALSE) ## ## ## ## r-PLS: 0.9299 ## ## P-value: 1e-04 ## ## Effect Size: 4.66235 ## ## Based on 10000 random permutations plot(it) References "]
]
